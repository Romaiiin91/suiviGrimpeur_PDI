<!--#include virtual="/incl/top_incl.shtml" -->

<!--#set var="param" val="Layout,Network.Enabled,ImageSource.NbrOfSources,ImageSource.I0.Name,ImageSource.I0.Video.Connector,Output.NbrOfOutputs,Input.NbrOfInputs,Properties.Image,System.BoaGroupPolicy,TemperatureControl,Properties.TemperatureSensor" -->
<!--#set var="param" val="$param$,Network.IPv6.Enabled" -->
<!--#set var="param" val="$param$,Properties.PTZ.PTZ,PTZ.Support" -->
<!--#include virtual="/sm/sm.srv?action=get&group=PTZ.UserAdv,PTZ.Various,PTZ.NbrOfCameras" -->
<!--#set var="param" val="$param$,HTTPS" -->
<!--#set var="param" val="$param$,StreamCache,StreamProfile" -->



<!--#set var="operatorOrAdminUser" val="no" -->
<!--#if expr="$http_user_realms >< ¤Administrator¤" -->
  <!--#set var="operatorOrAdminUser" val="yes" -->
<!--#elif expr="$http_user_realms >< ¤Operator¤" -->
  <!--#set var="operatorOrAdminUser" val="yes" -->
<!--#endif -->
<!--#if expr="$operatorOrAdminUser = yes" -->
  <!--#set var="param" val="$param$,Properties.Motion" -->
  <!--#set var="reservedName" val="Gatekeeper" -->
<!--#endif -->
<!--#set var="param" val="$param$,Properties.GuardTour" -->





<!--#include virtual="/sm/sm.srv?action=get&group=$param$" -->

<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->
  <!--#include virtual="/sm/sm.srv?action=get&group=ImageSource.I1.Name,ImageSource.I1.Video.Connector" -->
  <!--#include virtual="/sm/sm.srv?action=get&group=ImageSource.I2.Name,ImageSource.I2.Video.Connector" -->
  <!--#include virtual="/sm/sm.srv?action=get&group=ImageSource.I3.Name,ImageSource.I3.Video.Connector" -->
<!--#endif -->

<!--#if expr="_$size = _" -->
  <!--#set var="size" val="1" -->
<!--#endif -->

<!--#if expr="$imagepath >< ://" -->
  <!--#set var="external" val="yes" -->
<!--#elif expr="$imagepath >< %3A//" -->
  <!--#set var="external" val="yes" -->
<!--#else -->
  <!--#set var="external" val="no" -->
<!--#endif -->


<!--#set var="camnbr" val="1" -->

<!--#set var="camTmpStr" val="camera=" -->

<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->
  <!--#if expr="$imagepath >< $camTmpStr" -->
    <!--#if expr="$imagepath >< $camTmpStr$2" -->
      <!--#set var="camnbr" val="2" -->
    <!--#elif expr="$imagepath >< $camTmpStr$3" -->
      <!--#set var="camnbr" val="3" -->
    <!--#elif expr="$imagepath >< $camTmpStr$4" -->
      <!--#set var="camnbr" val="4" -->
    <!--#elif expr="$imagepath >< $camTmpStr$quad" -->
      <!--#set var="camnbr" val="quad" -->
    <!--#endif -->
  <!--#else -->
    <!--#if expr="$imagepath >< /2/" -->
      <!--#set var="camnbr" val="2" -->
    <!--#elif expr="$imagepath >< /3/" -->
      <!--#set var="camnbr" val="3" -->
    <!--#elif expr="$imagepath >< /4/" -->
      <!--#set var="camnbr" val="4" -->
    <!--#elif expr="$imagepath >< /quad/" -->
      <!--#set var="camnbr" val="quad" -->
    <!--#endif -->
  <!--#endif -->
<!--#endif -->

<!--#if expr="$external = yes" -->
  <!--#set var="fmt" val="$root_Layout_DefaultVideoFormat$+" -->
<!--#elif expr="$imagepath = " -->
  <!--#set var="fmt" val="$root_Layout_DefaultVideoFormat$+" -->
<!--#elif expr="$imagepath >< mpeg4" -->
  <!--#set var="fmt" val="mpeg4+" -->
<!--#elif expr="$imagepath >< h264" -->
  <!--#set var="fmt" val="h264+" -->
<!--#else -->
  <!--#set var="fmt" val="mjpeg+" -->
<!--#endif -->


<!--#set var="selectedprofile" val="$fmt" -->
<!--#if expr="_$imagePath != _" -->
  <!--#if expr="_$streamprofile != _" --><!--#set var="selectedprofile" val="$streamprofile" --><!--#endif -->
<!--#else -->
  <!--#if expr="_$root_Layout_DefaultStreamProfile != _" --><!--#set var="selectedprofile" val="$root_Layout_DefaultStreamProfile" --><!--#endif -->
  <!--#set var="streamprofile" val="$root_Layout_DefaultStreamProfile$" -->
<!--#endif -->

<!--#set var="imagesize_opts" val="" -->
<!--#if expr="_$streamprofile != _" -->
  <!--#if expr="$invalidProfile != yes" -->
    <!--#set var="imagesize_opts" val="$imagesize_opts$&streamprofile=$streamprofile$" -->
  <!--#endif -->
<!--#endif -->
<!--#include virtual="/axis-cgi/view/imagesize.cgi?format=ssi&camera=$camnbr$$imagesize_opts$" -->

<!--#set var="checkResolution" value="no" -->

<!--#set var="snapshotWidth" val="$img_width$" -->
<!--#set var="snapshotHeight" val="$img_height$" -->

<!--#set var="showSizeButtons" val="no" -->

<!--#if expr="$root_Properties_PTZ_PTZ = yes" -->
  <!--#include virtual="/incl/setabsrel.shtml" -->
<!--#endif -->

<!--#set var="showPTZCrosshair" val="yes" -->

<!--#if expr="_$root_ImageSource_NbrOfSources = _" -->
  <!--#set var="root_ImageSource_NbrOfSources" val="0" -->
<!--#endif -->
<!--#if expr="_$root_Output_NbrOfOutputs = _" -->
  <!--#set var="root_Output_NbrOfOutputs" val="0" -->
<!--#endif -->
<!--#if expr="$external = yes" -->
  <!--#set var="showPTZBars" val="no" -->
  <!--#set var="useWithCam" val="no" -->
<!--#endif -->


<!--#set var="UseAudio" val="no" -->



<!--#if expr="$root_Layout_Axis = no" -->
<style type="text/css">

.bodyBg         { background-color: <!--#if expr="$root_Layout_OwnBGColorEnabled = yes" --><!--#echo var="root_Layout_OwnBGColor" option="encoding:html" --><!--#else -->white<!--#endif --> }
.normalText     { color: <!--#if expr="$root_Layout_OwnTextColorEnabled = yes" --><!--#echo var="root_Layout_OwnTextColor" option="encoding:html" --><!--#else -->#000<!--#endif -->; font-family: verdana, arial, helvetica, san-serif; font-size: 10px; font-weight: normal }
.footnote       { color: <!--#if expr="$root_Layout_OwnTextColorEnabled = yes" --><!--#echo var="root_Layout_OwnTextColor" option="encoding:html" --><!--#else -->#000<!--#endif -->; font-family: verdana, arial, helvetica, san-serif; font-size: 10px; font-weight: normal }
.fixed_text     { color: <!--#if expr="$root_Layout_OwnTextColorEnabled = yes" --><!--#echo var="root_Layout_OwnTextColor" option="encoding:html" --><!--#else -->#000<!--#endif -->; font-family: courier new, courier, fixed; font-size: 12px; font-weight: normal }
.fixed_title    { color: <!--#if expr="$root_Layout_OwnTextColorEnabled = yes" --><!--#echo var="root_Layout_OwnTextColor" option="encoding:html" --><!--#else -->#000<!--#endif -->; font-family: courier new, courier, fixed; font-size: 12px; font-weight: normal }
.funcText       { color: <!--#if expr="$root_Layout_OwnTextColorEnabled = yes" --><!--#echo var="root_Layout_OwnTextColor" option="encoding:html" --><!--#else -->#666666<!--#endif -->; font-family: verdana, arial, helvetica, sans-serif; font-size: 10px; font-weight: normal }
.linkActive     { color: <!--#if expr="$root_Layout_OwnTextColorEnabled = yes" --><!--#echo var="root_Layout_OwnTextColor" option="encoding:html" --><!--#else -->#666666<!--#endif -->; font-family: verdana, arial, helvetica, sans-serif; font-size: 13px; font-weight: bold }
.linkInActive   { color: <!--#if expr="$root_Layout_OwnTextColorEnabled = yes" --><!--#echo var="root_Layout_OwnTextColor" option="encoding:html" --><!--#else -->#3366cc<!--#endif -->; font-family: verdana, arial, helvetica, sans-serif; font-size: 13px; font-weight: bold }

</style>


<!--#endif -->

<!--#set var="includeSoapclient" val="no" -->
  <!--#if expr="$operatorOrAdminUser = yes" -->
    <!--#set var="includeSoapclient" val="yes" -->
  <!--#endif -->
<!--#if expr="$includeSoapclient = yes" -->
  <script src="/incl/soapclient.js?ver=<!--#echo var="root_Properties_Firmware_Version" option="encoding:url" -->" language="javascript" type="text/javascript"></script>
<!--#endif -->





<script language="JavaScript">
<!--
var langObjView = new Language("platoon", "view");

if ((navigator.appName == "Microsoft Internet Explorer") &&
    (navigator.platform != "MacPPC") &&
    (navigator.platform != "Mac68k")) {
  var browser = "IE"
} else {
  var browser = "Netscape"
}


  <!--#include virtual="/incl/profile_funcs.shtml" -->

function outputBox(title, elArr, spacerAfter, spacerBefore, fillWhole, otherOutputTr, id)
{
  var blankImage5x5 = document.createElement("img");
  blankImage5x5.src = "/pics/blank.gif";
  blankImage5x5.style.width = "5px";
  blankImage5x5.style.height = "5px";
  blankImage5x5.style.border = "0";

  var blankImage4x5 = document.createElement("img");
  blankImage4x5.src = "/pics/blank.gif";
  blankImage4x5.style.width = "4px";
  blankImage4x5.style.height = "5px";
  blankImage4x5.style.border = "0";

  var blankImage1x5 = document.createElement("img");
  blankImage1x5.src = "/pics/blank.gif";
  blankImage1x5.style.width = "1px";
  blankImage1x5.style.height = "5px";
  blankImage1x5.style.border = "0";

  var mainCell = document.createElement("td");

  if (id)
    mainCell.id = id;

  if(fillWhole == true)
    mainCell.style.width = "100%";

  var tbl1 = document.createElement("table");
  tbl1.style.width = "100%";
  tbl1.style.height = "46px";
  tbl1.cellPadding = "0";
  tbl1.cellSpacing = "0";
  tbl1.style.border = "0";

  var tbl1Tbody = document.createElement("tbody");

  var tbl1Row1 = document.createElement("tr");
  tbl1Row1.className="top-mainborder";

  var tbl1Row1Cell1 = document.createElement("td");
  tbl1Row1Cell1.colSpan = 2;
  tbl1Row1Cell1.style.width = "5px";
  tbl1Row1Cell1.style.backgroundImage = "url(\"/pics/gray_corner_lt_5x50px.gif\")";
  tbl1Row1Cell1.appendChild( blankImage5x5.cloneNode(false) );

  var tbl1Row1Cell2 = document.createElement("td");
  tbl1Row1Cell2.vAlign = "top";
  tbl1Row1Cell2.align = "center";
  tbl1Row1Cell2.style.width = "100%";
  tbl1Row1Cell2.style.height = "5px";
  tbl1Row1Cell2.className = "funcText";
  tbl1Row1Cell2.style.whiteSpace = "nowrap";
  tbl1Row1Cell2.style.backgroundImage = "url(\"/pics/gray_t_5x50px.gif\")";
  tbl1Row1Cell2.innerHTML = title;

  var tbl1Row1Cell3 = document.createElement("td");
  tbl1Row1Cell3.colSpan = 2;
  tbl1Row1Cell3.style.width = "5px";
  tbl1Row1Cell3.style.backgroundImage = "url(\"/pics/gray_corner_rt_5x50px.gif\")";
  tbl1Row1Cell3.appendChild( blankImage5x5.cloneNode(false) );

  var tbl1Row2 = document.createElement("tr");

  var tbl1Row2Cell1 = document.createElement("td");
  tbl1Row2Cell1.style.width = "1px";
  tbl1Row2Cell1.className = "lineBg";
  tbl1Row2Cell1.appendChild( blankImage1x5.cloneNode(false) );

  var tbl1Row2Cell2 = document.createElement("td");
  tbl1Row2Cell2.style.width = "4px";
  tbl1Row2Cell2.appendChild( blankImage4x5.cloneNode(false) );

  var tbl1Row2Cell3 = document.createElement("td");
  tbl1Row2Cell3.vAlign = "middle";
  tbl1Row2Cell3.align = "center";
  tbl1Row2Cell3.style.width = "100%";

  var tbl2 = document.createElement("table");
  tbl2.cellPadding = "0";
  tbl2.cellSpacing = "0";
  tbl2.style.border = "0";

  var tbl2Tbody = document.createElement("tbody");

  var tbl2Row1 = document.createElement("tr");

  var retEl;
  for(var i=0; i < elArr.length; i++)
  {
    retEl = null;

    if(elArr[i].type == "button")
    {
      retEl = getButtonForBox(elArr[i].pic, elArr[i].alt, elArr[i].url, elArr[i].name, elArr[i].pressed, elArr[i].onClick, elArr[i].width, elArr[i].height, elArr[i].id);
    }
    else if(elArr[i].type == "select")
    {
      retEl = getSelectForBox(elArr[i].name, elArr[i].onChange, elArr[i].disabled, elArr[i].optionArr, elArr[i].extraOptionArr, elArr[i].extraCode);
    }
    else if(elArr[i].type == "toggle")
    {
      retEl = getToggleForBox(elArr[i].nameActive, elArr[i].nameInactive, elArr[i].picActivePressed, elArr[i].picActive, elArr[i].picInactivePressed, elArr[i].picInactive, elArr[i].urlActive, elArr[i].urlInactive, elArr[i].initStatusActive, elArr[i].altActive, elArr[i].altInactive);
    }
    else if(elArr[i].type == "slider")
    {
      retEl = getSliderForBox(elArr[i].name, elArr[i].val, elArr[i].images);
    }
    else if(elArr[i].type == "inputOutput")
    {
      retEl = getInputOutputForBox(elArr[i].inNbr, elArr[i].outNbr);
    }
    else if(elArr[i].type == "empty")
    {
      retEl = document.createElement("td");
      retEl.vAlign = "middle";
      retEl.align = "left";
      retEl.innerHTML = "<br>";
    }

    if(retEl != null)
    {
      if( retEl instanceof Array)
      {
        tbl2Row1.appendChild( retEl[0] );
        tbl2Row1.appendChild( retEl[1] );
      }
      else
        tbl2Row1.appendChild( retEl );
    }
  }

  var tbl1Row2Cell4 = document.createElement("td");
  tbl1Row2Cell4.style.width = "4px";
  tbl1Row2Cell4.appendChild( blankImage4x5.cloneNode(false) );

  var tbl1Row2Cell5 = document.createElement("td");
  tbl1Row2Cell5.style.width = "1px";
  tbl1Row2Cell5.className = "lineBg";
  tbl1Row2Cell5.appendChild( blankImage1x5.cloneNode(false) );

  var tbl1Row3 = document.createElement("tr");
  tbl1Row3.className="bottom-mainborder";

  var tbl1Row3Cell1 = document.createElement("td");
  tbl1Row3Cell1.colSpan = 2;
  tbl1Row3Cell1.style.width = "5px";
  tbl1Row3Cell1.style.backgroundImage = "url(\"/pics/line_corner_lb_5x5px.gif\")";
  tbl1Row3Cell1.appendChild( blankImage5x5.cloneNode(false) );

  var tbl1Row3Cell2 = document.createElement("td");
  tbl1Row3Cell2.style.width = "100%";
  tbl1Row3Cell2.style.height = "5px";
  tbl1Row3Cell2.style.backgroundImage = "url(\"/pics/line_b_100x5px.gif\")";
  tbl1Row3Cell2.appendChild( blankImage1x5.cloneNode(false) );

  var tbl1Row3Cell3 = document.createElement("td");
  tbl1Row3Cell3.colSpan = 2;
  tbl1Row3Cell3.style.width = "5px";
  tbl1Row3Cell3.style.height = "5px";
  tbl1Row3Cell3.style.backgroundImage = "url(\"/pics/line_corner_rb_5x5px.gif\")";
  tbl1Row3Cell3.appendChild( blankImage5x5.cloneNode(false) );

  var spacerCell = document.createElement("td");
  spacerCell.style.width = "5px";
  spacerCell.appendChild( blankImage5x5.cloneNode(false) );


  //Append everything created
  tbl1Row1.appendChild( tbl1Row1Cell1 );
  tbl1Row1.appendChild( tbl1Row1Cell2 );
  tbl1Row1.appendChild( tbl1Row1Cell3 );

  tbl1Row2.appendChild( tbl1Row2Cell1 );
  tbl1Row2.appendChild( tbl1Row2Cell2 );

  tbl2Tbody.appendChild( tbl2Row1 );
  tbl2.appendChild( tbl2Tbody );
  tbl1Row2Cell3.appendChild( tbl2 );

  tbl1Row2.appendChild( tbl1Row2Cell3 );
  tbl1Row2.appendChild( tbl1Row2Cell4 );
  tbl1Row2.appendChild( tbl1Row2Cell5 );

  tbl1Row3.appendChild( tbl1Row3Cell1 );
  tbl1Row3.appendChild( tbl1Row3Cell2 );
  tbl1Row3.appendChild( tbl1Row3Cell3 );

  tbl1Tbody.appendChild( tbl1Row1 );
  tbl1Tbody.appendChild( tbl1Row2 );
  tbl1Tbody.appendChild( tbl1Row3 );

  tbl1.appendChild( tbl1Tbody );
  mainCell.appendChild( tbl1 );

  var appenderTr = "appendableTr";
  if(otherOutputTr != null)
    appenderTr = otherOutputTr;

  if(spacerBefore)
    document.getElementById(appenderTr).appendChild( spacerCell );

  document.getElementById(appenderTr).appendChild( mainCell );

  if(spacerAfter)
    document.getElementById(appenderTr).appendChild( spacerCell );
}

function getButtonForBox(pic, alt, url, name, pressed, onClick, width, height, id)
{
  var td = document.createElement("td");
  td.vAlign = "middle";
  td.align = "left";

  var a = document.createElement("a");
  var img = document.createElement("img");

  if(url)
  {
    a.href = url;

    if(onClick)
      a.onclick = new Function(onClick);

    if(name)
    {
      a.id = name+"_link";
      if (typeof url == "string" && url.toLowerCase().indexOf("javascript:") != 0)
      {
        a.target = "Temp";
      }
      a.onmousedown = function() { movepic( name, pressed) };
      a.onmouseup = function() { movepic( name, pic) };
      img.name = name;
    }
    else
      a.target = "_self";
  }

  img.src = pic;
  if(width)
    img.style.width = width;
  else
    img.style.width = "27px";

  if(height)
    img.style.height = height;
  else
    img.style.height = "27px";

  img.border = "0";

  if(id)
    img.id = id;

  if(alt)
  {
    img.alt = alt;
    img.title = alt;
  }

  if(a.href)
  {
    a.appendChild( img );
    td.appendChild( a );
  }
  else
    td.appendChild( img );

  return td;
}

function getSelectForBox(name, onChange, disabled, optionArr, extraOptionArr, extraCode)
{
  var td = document.createElement("td");
  td.vAlign = "middle";
  td.align = "left";

  var select = document.createElement("select");
  select.name = name;
  select.id = name;
  if( select.addEventListener )
    select.addEventListener('change', onChange, false);
  else
    select.attachEvent('onchange', onChange);

  if(disabled)
    select.disabled = true;

  langObjView.addOptionsToList(select, optionArr);

  if(extraOptionArr)
    langObjView.addOptionsToList(select, extraOptionArr);

  td.appendChild( select );

  if(extraCode)
  {
    if( typeof( extraCode ) != "string" )
    {
      td.appendChild( extraCode );
    }
    else
    {
      td.innerHTML += extraCode;
    }
  }

  return td;
}

function getToggleForBox(nameActive, nameInactive, picActivePressed, picActive, picInactivePressed, picInactive, urlActive, urlInactive, initStatusActive, altActive, altInactive)
{
  var td = document.createElement("td");
  td.vAlign = "middle";
  td.align = "left";

  var a = document.createElement("a");
  a.id = nameActive+"_link";
  a.href = urlActive;
  if (typeof urlActive == "string" && urlActive.toLowerCase().indexOf("javascript:") != 0)
  {
    a.target = "Temp";
  }
  a.onmousedown = function() { movepic( nameActive, picActivePressed); movepic( nameInactive, picInactive); };

  var img = document.createElement("img");
  img.name = nameActive;
  img.src = (initStatusActive ? picActivePressed : picActive);
  img.width = "27";
  img.height = "27";
  img.border = "0";
  img.alt = altActive;
  img.title = altActive;

  a.appendChild( img );

  var td1 = document.createElement("td");
  td1.vAlign = "middle";
  td1.align = "left";

  var a1 = document.createElement("a");
  a1 = document.createElement("a");
  a1.id = nameInactive+"_link";
  a1.href = urlInactive;
  if (typeof urlInactive == "string" && urlInactive.toLowerCase().indexOf("javascript:") != 0)
  {
    a1.target = "Temp";
  }
  a1.onmousedown = function() { movepic( nameActive, picActive); movepic( nameInactive, picInactivePressed); };

  img1 = document.createElement("img");
  img1.name = nameInactive;
  img1.src = (initStatusActive ? picInactivePressed : picInactive);
  img1.width = "27";
  img1.height = "27";
  img1.border = "0";
  img1.alt = altInactive;
  img1.title = altInactive;

  a1.appendChild( img1 );

  td.appendChild( a );

  td1 = document.createElement("td");
  td1.appendChild( a1 );

  var retArr = new Array();
  retArr.push( td );
  retArr.push( td1 );

  return retArr;
}

function getSliderForBox(name, val, images)
{
  var td = document.createElement("td");
  td.vAlign = "middle";
  td.style.whiteSpace = "nowrap";

  var sliderImg;
  for(var j=0; j < images.length; j++)
  {
    sliderImg = document.createElement("img");
    sliderImg.id = images[j].id;
    sliderImg.src = images[j].src;
    sliderImg.style.width = images[j].width;
    sliderImg.style.height = images[j].height;
    sliderImg.style.display = "inline";

    td.appendChild( sliderImg );
  }

  td1 = document.createElement("td");

  var inp = document.createElement("input");
  inp.type = "hidden";
  inp.name = name;
  inp.id = name;
  inp.size = 4;
  inp.value = val;

  td1.appendChild( inp );

  var retArr = new Array();
  retArr.push( td );
  retArr.push( td1 );

  return retArr;
}

function getInputOutputForBox(inNbr, outNbr)
{
  var ioTable = document.createElement("table");
  ioTable.cellPadding = "0";
  ioTable.cellSpacing = "0";
  ioTable.style.border = "0";
  ioTable.style.width = "768px";

  var ioTableTbody = document.createElement("tbody");

  var ioTableRow1 = document.createElement("tr");

  var ioTableRow1Cell1 = document.createElement("td");
  ioTableRow1Cell1.vAlign = "middle";
  ioTableRow1Cell1.align = "left";
  ioTableRow1Cell1.style.width = "10%";
  ioTableRow1Cell1.style.whiteSpace = "nowrap";
  ioTableRow1Cell1.innerHTML = langObjView.getText("inpPortsTxt");

  ioTableRow1.appendChild( ioTableRow1Cell1 );

  var ioTableRow1Cell2X = document.createElement("td");
  ioTableRow1Cell2X.vAlign = "middle";
  ioTableRow1Cell2X.align = "center";
  ioTableRow1Cell2X.style.width = "10%";

  var inLoopMainTd;
  var inLoopTbl;
  var inLoopTbody;
  var inLoopTr1;
  var inLoopTr1Td;
  var inLoopTr1TdSpan;
  var inLoopTr2;
  var inLoopTr2Td;
  var inLoopTr2TdSpan;
  for(var i=0; i < inNbr; i++)
  {
    inLoopMainTd = ioTableRow1Cell2X.cloneNode(false);

    inLoopTbl = document.createElement("table");
    inLoopTbl.style.border = "0";
    inLoopTbody = document.createElement("tbody");

    inLoopTr1 = document.createElement("tr");
    inLoopTr1Td = document.createElement("td");
    inLoopTr1Td.align = "center";
    inLoopTr1TdSpan = document.createElement("span");
    inLoopTr1TdSpan.id = "inname"+i;
    inLoopTr2 = document.createElement("tr");
    inLoopTr2Td = document.createElement("td");
    inLoopTr2Td.align = "center";
    inLoopTr2Td.vAlign = "middle";
    inLoopTr2TdSpan = document.createElement("span");
    inLoopTr2TdSpan.id = "instat"+i;

    inLoopTr1Td.appendChild( inLoopTr1TdSpan );
    inLoopTr1.appendChild( inLoopTr1Td );

    inLoopTr2Td.appendChild( inLoopTr2TdSpan );
    inLoopTr2.appendChild( inLoopTr2Td );

    inLoopTbody.appendChild( inLoopTr1 );
    inLoopTbody.appendChild( inLoopTr2 );

    inLoopTbl.appendChild( inLoopTbody );
    inLoopMainTd.appendChild( inLoopTbl );

    ioTableRow1.appendChild( inLoopMainTd );
  }

  var ioTableRow2 = document.createElement("tr");

  var ioTableRow2Cell1 = ioTableRow1Cell1.cloneNode(false);
  ioTableRow2Cell1.innerHTML = langObjView.getText("outPortsTxt");

  ioTableRow2.appendChild( ioTableRow2Cell1 );

  var ioTableRow2Cell2X = ioTableRow1Cell2X.cloneNode(false);

  var outLoopMainTd;
  var outLoopTbl;
  var outLoopTbody;
  var outLoopTr1;
  var outLoopTr1Td;
  var outLoopTr1TdSpan;
  var outLoopTr2;
  var outLoopTr2Td;
  var outLoopTr2TdSpan1;
  var outLoopTr2TdSpan2;
  var outLoopTr2TdSpan3;
  for(var i=0; i < outNbr; i++)
  {
    outLoopMainTd = ioTableRow2Cell2X.cloneNode(false);

    outLoopTbl = document.createElement("table");
    outLoopTbl.style.border = "0";
    outLoopTbody = document.createElement("tbody");

    outLoopTr1 = document.createElement("tr");
    outLoopTr1Td = document.createElement("td");
    outLoopTr1Td.align = "center";
    outLoopTr1TdSpan = document.createElement("span");
    outLoopTr1TdSpan.id = "outname"+i;
    outLoopTr2 = document.createElement("tr");
    outLoopTr2Td = document.createElement("td");
    outLoopTr2Td.align = "center";
    outLoopTr2Td.vAlign = "middle";
    outLoopTr2TdSpan = document.createElement("span");
    outLoopTr2TdSpan1.id = "outon"+i;
    outLoopTr2TdSpan2 = document.createElement("span");
    outLoopTr2TdSpan2.id = "outpulse"+i;
    outLoopTr2TdSpan3 = document.createElement("span");
    outLoopTr2TdSpan3.id = "outoff"+i;


    outLoopTr1Td.appendChild( outLoopTr1TdSpan );
    outLoopTr1.appendChild( outLoopTr1Td );

    outLoopTr2Td.appendChild( outLoopTr2TdSpan1 );
    outLoopTr2Td.appendChild( outLoopTr2TdSpan2 );
    outLoopTr2Td.appendChild( outLoopTr2TdSpan3 );
    outLoopTr2.appendChild( outLoopTr2Td );

    outLoopTbody.appendChild( outLoopTr1 );
    outLoopTbody.appendChild( outLoopTr2 );

    outLoopTbl.appendChild( outLoopTbody );
    outLoopMainTd.appendChild( outLoopTbl );

    ioTableRow2.appendChild( outLoopMainTd );
  }

  //appendEverything created for input/output
  ioTableTbody.appendChild( ioTableRow1 );
  ioTableTbody.appendChild( ioTableRow2 );
  ioTable.appendChild( ioTableTbody );

  var td = document.createElement("td");
  td.appendChild( ioTable );

  return td;
}


// Draw the scale buttons
function drawScaleButtons()
{
  var currentResolution = 0
  var width = 0
  var height = 0
  var imagepath = "<!--#echo var="imagepath" option="encoding:url" -->"
  var resStart = imagepath.indexOf("resolution=")
  if (resStart != -1) {
    var resStop = imagepath.indexOf("&", resStart)
    if (resStop == -1) resStop = imagepath.length
    currentResolution = imagepath.substring(resStart + 11, resStop);
    width = parseInt(currentResolution.substring(0, currentResolution.indexOf('x')), 10);
    height = parseInt(currentResolution.slice((currentResolution.indexOf('x') + 1)), 10);
  } else {
    width = "<!--#echo var="img_width" option="encoding:javascript" -->";
    height = "<!--#echo var="img_height" option="encoding:javascript" -->";
    currentResolution = width + 'x' + height;
  }

  if (currentResolution.indexOf("x") != -1) {
    var currentWidth  = parseInt(currentResolution.substring(0, currentResolution.indexOf("x")), 10),
        currentHeight = parseInt(currentResolution.slice((currentResolution.indexOf('x') + 1)), 10);
    if (!((currentWidth <= 800 && currentHeight <= 600) || (currentWidth <= 600 && currentHeight <= 800)))
    {
      scaleArr = new Array();
      scaleArr.push( {type: "button", pic: "/pics/button_downsize_gray_27x27px.gif", alt: langObjView.getText("adjToBrSizeTxt"), url: "JavaScript:dynamicResize(true)", id: "adjustSize"} );
      scaleArr.push( {type: "button", pic: "/pics/button_x1_gray_27x27px.gif", alt: langObjView.getText("fuImTxt"), url: "JavaScript:dynamicResize(false)", id: "fullSize"} );
      outputBox(langObjView.getText("viewSizeTxt"), scaleArr, true);
    }
  }
}

<!--#if expr="$showSizeButtons != no" -->
//draw the size buttons
function drawSizeButtons()
{
  var viewSizeArr = new Array();
<!--#if expr="$size = 0.5" -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x05_gray_27x27px.gif", alt: "x 1/2"} );
<!--#else -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x05_27x27px.gif", alt: "x 1/2", url: "JavaScript:zoom(0.5)"} );
<!--#endif -->
<!--#if expr="$size = 1" -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x1_gray_27x27px.gif", alt: "x 1"} );
<!--#else -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x1_27x27px.gif", alt: "x 1", url: "JavaScript:zoom(1)"} );
<!--#endif -->
<!--#if expr="$size = 2" -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x2_gray_27x27px.gif", alt: "x 2"} );
<!--#else -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x2_27x27px.gif", alt: "x 2", url: "JavaScript:zoom(2)"} );
<!--#endif -->
<!--#if expr="$size = 4" -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x4_gray_27x27px.gif", alt: "x 4"} );
<!--#else -->
  viewSizeArr.push( {type: "button", pic: "/pics/button_x4_27x27px.gif", alt: "x 4", url: "JavaScript:zoom(4)"} );
<!--#endif -->

  outputBox(langObjView.getText("viewSizeTxt"), viewSizeArr, true);
}
<!--#endif -->



  function newVideoFormat()
  {
    newVideoFormatCam('<!--#echo var="camnbr" option="encoding:javascript" -->');
  }

  function newVideoFormatCam(cam)
  {
    var url = "";
    var options = "";
<!--#if expr="$root_Layout_ShowVideoFormatDropDown = yes" -->
    var selvalue = "#UNSELECTABLE#";
    var oVideoFormat = document.WizardForm.videoFormat;
    if( oVideoFormat && oVideoFormat.selectedIndex >= 0 )
    {
      selvalue = oVideoFormat[oVideoFormat.selectedIndex].value;
    }
<!--#else -->
    var defaultStreamProfile = getProfileGrp(document.profileForm,"<!--#echo var="root_Layout_DefaultStreamProfile" option="encoding:javascript" -->");
    var defaultVideoFormat = "<!--#echo var="root_Layout_DefaultVideoFormat" option="encoding:javascript" -->";
    var selvalue = ( defaultStreamProfile == "" ? defaultStreamProfile : defaultVideoFormat );
<!--#endif -->

    if( selvalue == "#UNSELECTABLE#")
    {
      return;
    }


    if (selvalue.toLowerCase() == "mjpeg")
    {
      url = '/mjpg<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->/' + cam + '<!--#endif -->/video.mjpg<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->?camera=' + cam + '<!--#endif -->';
    }
    else if (selvalue.toLowerCase() == "mpeg4")
    {
      url = '/axis-media/media.amp?videocodec=mpeg4<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->&camera=' + cam + '<!--#endif -->';
    }
    else if (selvalue.toLowerCase() == "h264")
    {
      url = '/axis-media/media.amp?videocodec=h264<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->&camera=' + cam + '<!--#endif -->';
    }
    else
    {
      var val = document.profileForm["root_StreamProfile_S" + selvalue + "_Name"].value;
      if (val) {
        options = "&streamprofile=" + val;
      }

      var enc = profileParseOption(document.profileForm["root_StreamProfile_S" + selvalue + "_Parameters"].value,"videocodec");
      if ((enc == "jpeg")<!--#if expr="$root_Layout_DefaultVideoFormat = mjpeg" --> || (enc == "")<!--#endif -->) {
        url = '/mjpg<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->/' + cam + '<!--#endif -->/video.mjpg<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->?camera=' + cam + '<!--#endif -->';
      }  else if ((enc == "mpeg4")<!--#if expr="$root_Layout_DefaultVideoFormat = mpeg4" --> || (enc == "")<!--#endif -->) {
        url = '/axis-media/media.amp?videocodec=mpeg4<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->&camera=' + cam + '<!--#endif -->';
      }  else if ((enc == "h264")<!--#if expr="$root_Layout_DefaultVideoFormat = h264" --> || (enc == "")<!--#endif -->) {
        url = '/axis-media/media.amp?videocodec=h264<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->&camera=' + cam + '<!--#endif -->';
      }
    }
    changeView(url, cam, '', '<!--#echo var="size" option="encoding:javascript" -->', options);
  }

<!--#if expr="$root_Layout_ShowVideoFormatDropDown = yes" -->
  <!--#if expr="$seq != yes" -->
    <!--#if expr="$external = no" -->

  // Draw the format drop down
  function writeFormatOptions()
  {
    var normOpArr = new Array();
    normOpArr.push( {val: "MJPEG", text: "Motion JPEG", selected: <!--#if expr="$selectedprofile = mjpeg+" -->true<!--#else -->false<!--#endif -->} );
    normOpArr.push( {val: "H264", text: "H.264", selected: <!--#if expr="$selectedprofile = h264+" -->true<!--#else -->false<!--#endif -->} );

    var profileform = document.profileForm;
    var extraOpArr = getProfileOptionsArray(profileform,"<!--#echo var="selectedprofile" option="encoding:javascript" -->");

    var elArr = new Array();
    elArr.push( {type: "select", name: "videoFormat", onChange: newVideoFormat, optionArr: normOpArr, extraOptionArr: extraOpArr, disabled: false } );

    outputBox(langObjView.getText("strProTxt"), elArr, true);

 }

    <!--#endif -->// $external = no
  <!--#endif -->// $seq != yes
<!--#endif -->// $root_Layout_ShowVideoFormatDropDown = yes






<!--#if expr="$root_Output_NbrOfOutputs != 0" -->
  // Draw the output buttons
  function drawOutputButtons()
  {
    var form = document.outputsForm;


    var OutputName = "";
    var unit = "";
    var value = 0;
    var displayValue = 0.0;

    var IO_Status = new Array(0);
    var IOStateO = "<!--#include virtual="/axis-cgi/iostate.cgi?o" -->";

    for (k = 0; k < (<!--#echo var="root_Output_NbrOfOutputs" option="encoding:javascript" -->+<!--#echo var="root_Input_NbrOfInputs" option="encoding:javascript" -->); k++)
    {
      if( IO_Status[k] == "output" && form["root_IOPort_I" + k + "_Output_Name"] ) {
        try {
          var OutputName = form["root_IOPort_I" + k + "_Output_Name"].value;
          var unit = form["root_IOPort_I" + k + "_Output_PulseTime"].value;
          var buttontype = form["root_IOPort_I" + k + "_Output_Button"].value;

          for (j = unit.length-1; j >= 0; j--) {
            if (unit.charAt(j) == "h") {
              var value = parseInt(unit, 10) * 10;
              var displayValue = parseFloat(unit)/100;
              break;
            } else if (unit.charAt(j) == "s") {
              var value = parseInt(unit, 10) * 1000;
              var displayValue = parseInt(unit, 10);
              break;
            }
          }

          if (buttontype != "none")
          {
            var elArr = new Array();

            if (buttontype == "actinact")
            {
              var initStatus = false;
              if( (IOStateO.charAt(k) == '1' && form["root_IOPort_I" + k + "_Output_Active"].value == "closed") || (IOStateO.charAt(k) == '0' && form["root_IOPort_I" + k + "_Output_Active"].value == "open") == true)
                initStatus = true;

              elArr.push( {type: "toggle", name: OutputName,
                        nameActive: "buttonOn0" + k, nameInactive: "buttonOff0" + k,
                        picActivePressed: "/pics/on_blue_pressed_button_27x27px.gif", picActive: "/pics/on_blue_button_27x27px.gif",
                        picInactivePressed: "/pics/off_blue_pressed_button_27x27px.gif", picInactive: "/pics/off_blue_button_27x27px.gif",
                        urlActive: "/axis-cgi/io/port.cgi?action=" + [k + 1] + ":/",
                        urlInactive: "/axis-cgi/io/port.cgi?action=" + [k + 1] + ":\\",
                        initStatusActive: initStatus,
                        altActive: langObjView.getText("actTxt")+" "+ [OutputName],
                        altInactive: langObjView.getText("inaTxt")+" "+ [OutputName] } );

            }
            else if (buttontype == "pulse")
            {
              elArr.push( {type: "button", pic: "/pics/pulse_blue_button_27x27px.gif",
                        alt: langObjView.getText("pls1Txt")+" " + [OutputName] + " "+langObjView.getText("pls2Txt")+" " + [displayValue] + " "+langObjView.getText("pls3Txt"),
                        url: "/axis-cgi/io/port.cgi?action=" + [k+1] + ":/" + value + "\\",
                        name: "PulseOff0" + [k],
                        pressed: "/pics/pulse_blue_button_pressed_27x27px.gif" } );
            }
            outputBox(OutputName, elArr, true);
          }
        }
        catch(e) {}
      }
    }
  }
<!--#endif -->








<!--#if expr="$root_Properties_GuardTour_RecordedTour = yes" -->
// Draw list for recorded tours
  function drawRecordedTours()
  {
    var opArr = new Array();
    opArr.push( {val: "", text: langObjView.getText("recTourLoadingTxt")} );

    var elArr = new Array();
    elArr.push( {type: "select", name: "recorded_tour_list", onChange: recorded_tour_actionsPlay, disabled: true, optionArr: opArr } );
    elArr.push( {type: "button", pic: "/pics/play_blue_button_27x27px.gif", alt: langObjView.getText("recTourPlayTxt"), url: "javascript:recorded_tour_actions('play');" } );
    elArr.push( {type: "button", pic: "/pics/stop_blue_button_27x27px.gif", alt: langObjView.getText("recTourStopTxt"), url: "javascript:recorded_tour_actions('stop');" } );

    outputBox(langObjView.getText("recTourTxt"), elArr, true);
  }

  function recorded_tour_actionsPlay()
  {
    recorded_tour_actions("play");
  }

  var guardTourObject;
  function recorded_tour_actions(action)
  {
    var selEl = document.getElementById("recorded_tour_list");
    var selectedTour = "";
    if( selEl && selEl.selectedIndex >= 0 )
    {
      selectedTour = selEl.options[selEl.selectedIndex].value;
    }
    if (selectedTour != "")
    {
      var url;
      var now = new Date();
      if (action == "play")
      {
        url = "/axis-cgi/recordedtour/play.cgi?recordedtourid=" + selectedTour + "&loop=0&schemaversion=1&timestamp="+now.getTime();
      }
      else if (action == "stop")
      {
        url = "/axis-cgi/recordedtour/stopplayback.cgi?recordedtourid=" + selectedTour + "&loop=0&schemaversion=1&timestamp="+now.getTime();
      }
      var ajax =  AxisConnectionFactory.sendSync(["GET", url], "", null);
    }
  }

  function guardTours_load()
  {
    guardTourObject = new guardtour_list("<!--#echo var="camnbr" option="encoding:javascript" -->", guardTours_loaded);
    guardTourObject.load("no", "yes");
  }

  function guardTours_loaded()
  {
    var recorded_tour_list = document.getElementById("recorded_tour_list");
    clearSelect(recorded_tour_list, false);
    addSelectOption(recorded_tour_list, "", "----------");
    if (guardTourObject.nbrOfRecordedToursInProduct > 0)
    {
      var guardtours = guardTourObject.get_guardtour_list();
      guardtours = guardtours.sort(sortTourName);
      for(var i = 0; i < guardtours.length; i++)
      {
        if (guardtours[i].camnbr == "<!--#echo var="camnbr" option="encoding:javascript" -->" && guardtours[i].itemType == "R");
        {
          addSelectOption(recorded_tour_list, guardtours[i].id, guardtours[i].name);
        }
      }
      if (recorded_tour_list.options.length > 1)
      {
        recorded_tour_list.disabled = false;
      }
    }
  }

  function sortTourName(a, b)
  {
    var A = a.name.toLowerCase();
    var B = b.name.toLowerCase();
    if (A > B)
      return 1;
    else if (A == B)
      return 0;
    else
      return -1;
  }


  function addSelectOption( selectEl, nodeValue, nodeText, isSelected, cls, beforeIndex )
  {
    var op = document.createElement("OPTION");
    op.value = nodeValue;
    op.text = nodeText;
    op.selected = isSelected;
    if( cls )
    {
      op.className = cls;
    }
    if( beforeIndex && beforeIndex < selectEl.length )
    {
      selectEl.options.add( op, beforeIndex );
    }
    else
    {
      selectEl.options.add( op );
    }
  }

  function clearSelect( el, keepFirst )
  {
    var removeTo = ((keepFirst)?1:0);

    while( el.length > removeTo )
    {
      el.remove( removeTo );
    }
  }

<!--#endif -->

  // Draw the sequence buttons and the list of sources
  var showSourceList = true;
  function drawSequenceButtons()
  {

    var boxTitle;
    var elArr = new Array();

    if (showSourceList && (<!--#echo var="root_ImageSource_NbrOfSources" option="encoding:javascript" --> > 1
        || document.listFormExt.elements.length > 0
<!--#if expr="$ptzpresets = yes" -->
  <!--#if expr="$root_PTZ_ImageSource_I0_PTZEnabled != false" -->
        || document.listFormPreset.elements.length > 0
  <!--#endif -->
<!--#endif -->))
    {
<!--#if expr="$root_PTZ_NbrOfCameras = 1" -->
      boxTitle = langObjView.getText("ptzPreTxt");
<!--#else -->
      boxTitle = langObjView.getText("vidStrPtzPreTxt");
<!--#endif -->
    } else {
      boxTitle = "<br>";
    }

    if ((("<!--#echo var="glob_PTZCamera" option="encoding:javascript" -->" != "yes") || ("<!--#echo var="ptzaccess" option="encoding:javascript" -->" == "yes")) && (seq_sources > 1))
    {
<!--#if expr="$seq = yes" -->
      elArr.push( {type: "button", pic: "/pics/button_sequence_gray_27x27px.gif", alt: langObjView.getText("seqModRunTxt") } );
      elArr.push( {type: "button", pic: "/pics/button_one_27x27px.gif", alt: langObjView.getText("stopSeqModTxt"), url: "JavaScript:sequence()" } );
<!--#else -->
      elArr.push( {type: "button", pic: "/pics/button_sequence_27x27px.gif", alt: langObjView.getText("viewSeqModTxt"), url: "JavaScript:sequence()" } );
      elArr.push( {type: "button", pic: "/pics/button_one_27x27px.gif", alt: langObjView.getText("segModeStopTxt") } );
<!--#endif -->
    }
    else
      elArr.push( {type: "button", pic: "/pics/space.gif", width: "1px" } );

<!--#set var="showSourceList" val="yes" -->
<!--#if expr="$glob_PTZCamera = yes" -->
  <!--#if expr="$root_ImageSource_I0_Video_Connector = bnc" -->
    <!--#set var="showSourceList" val="no" -->
  <!--#endif -->
<!--#endif -->
<!--#if expr="$showSourceList = yes" -->
  <!--#if expr="$root_PTZ_ImageSource_I0_PTZEnabled != false" -->
    if (showSourceList)
    {
      var listVidEl = listVideoSources();

      if(listVidEl != null)
        elArr.push( listVidEl );
    }
    else
      elArr.push( {type: "empty"} );
  <!--#else -->
    elArr.push( {type: "empty"} );
  <!--#endif -->
<!--#endif -->

    outputBox(boxTitle, elArr, false, false, true);

  }

  // Draw the trigger buttons
  function drawTriggerButtons()
  {
<!--#if expr="$root_ImageSource_NbrOfSources = 1" -->
    addTriggerButtons(langObjView.getText("triTxt"), 0);
<!--#else -->

    var indx = getTriggerIndex();

    if( indx >= 0 && indx < <!--#echo var="root_ImageSource_NbrOfSources" option="encoding:javascript" --> )
    {
      addTriggerButtons(langObjView.getText("triTxt")+" "+ (indx + 1), indx);
    }
<!--#endif -->
  }

  function addTriggerButtons(button_name, indx)
  {
    if (document.WizardForm["root_Layout_Trigger_T" + indx + "_Enabled"].value != "yes")
      return;

    var elArr = new Array();
    elArr.push( {type: "button", pic: "/pics/on_blue_button_27x27px.gif",
                        alt: button_name +" "+langObjView.getText("onTxt"),
                        url: "/axis-cgi/io/virtualinput.cgi?action=" + [indx + 6] + ":/",
                        name: "buttonOn",
                        pressed: "/pics/on_blue_pressed_button_27x27px.gif" } );
    elArr.push( {type: "button", pic: "/pics/off_blue_button_27x27px.gif",
                        alt: button_name +" "+langObjView.getText("offTxt"),
                        url: "/axis-cgi/io/virtualinput.cgi?action=" + [indx + 6] + ":\\",
                        name: "buttonOff",
                        pressed: "/pics/off_blue_pressed_button_27x27px.gif" } );

    outputBox(button_name, elArr, false, true);
  }

  function getTriggerIndex()
  {
   var triggerIndex = 0;
/*
    var oVideoList = document.WizardForm.videoList;
    var triggerIndex = -1;
    if( oVideoList )
    {
      triggerIndex = oVideoList.selectedIndex;
    }
*/
    var camnbr = '<!--#echo var="camnbr" option="encoding:javascript" -->';
    var triggerIndex = parseInt(camnbr, 10);
    if( typeof( triggerIndex ) != "number" ) {
      triggerIndex = 0;
    }
    else {
      triggerIndex -= 1;
    }
    return triggerIndex;
  }

<!--#if expr="$root_Properties_TemperatureSensor_Fan = yes" -->
  <!--#if expr="$root_Layout_FanEnabled = yes" -->
  // Draw the fan button
  function drawFanButton()
  {
    var elArr = new Array();
    elArr.push( {type: "button", pic: "/pics/button_fan_27x27px.gif",
                        alt: langObjView.getText("fanManDurTxt"),
                        url: "javaScript:startTemperatureControlForFan()"} );

    outputBox( langObjView.getText("fanTxt"), elArr, false, true);
  }

  function startTemperatureControlForFan()
  {
    <!--#if expr="$root_TemperatureControl_Fan_F0_UserControlSupport != no" -->
      startTemperatureControl("fan", 0);
    <!--#endif -->
    <!--#if expr="$root_TemperatureControl_Fan_F1_UserControlSupport != no" -->
        startTemperatureControl("fan", 1);
    <!--#endif -->
    <!--#if expr="$root_TemperatureControl_Fan_F2_UserControlSupport != no" -->
        startTemperatureControl("fan", 2);
    <!--#endif -->
  }
  <!--#endif -->
<!--#endif -->

<!--#if expr="$root_Properties_TemperatureSensor_Heater = yes" -->
  <!--#if expr="$root_Layout_HeaterEnabled = yes" -->
  // Draw the heater button
  function drawHeaterButton()
  {
    var elArr = new Array();
    elArr.push( {type: "button", pic: "/pics/button_heater_27x27px.gif",
                        alt: langObjView.getText("heaterManDurTxt"),
                        url: "javaScript:startTemperatureControlForHeater()"} );

    outputBox(langObjView.getText("heaterTxt"), elArr, false, true);
  }

  function startTemperatureControlForHeater()
  {
    <!--#if expr="$root_TemperatureControl_Heater_H0_UserControlSupport != no" -->
      startTemperatureControl("heater", 0);
    <!--#endif -->
  }
  <!--#endif -->
<!--#endif -->



<!--#if expr="$root_Layout_SnapshotEnabled = yes" -->
  // Draw the snapshot button
  function drawSnapshotButton()
  {
    var elArr = new Array();
    elArr.push( {type: "button", pic: "/pics/button_shot_27x27px.gif",
                        alt: langObjView.getText("snaTxt"),
                        url: "#",
                        onClick: "snapshotWrapper()" } );
     outputBox( langObjView.getText("snaTxt"), elArr, false, true);
  }

  function snapshotWrapper()
  {
    snapshot(<!--#if expr="_$imagepath != _" -->"<!--#echo var="imagepath" option="encoding:url" -->"<!--#else -->"/mjpg/video.mjpg"<!--#endif -->);
    return false;
  }
<!--#endif -->

<!--#if expr="$operatorOrAdminUser = yes" -->
<!--#if expr="$root_PTZ_Preset_P$nbr$_HomePosition != -1" -->
  var wsdlUrl = "/wsdl/vapix/ActionService.wsdl";

  var actionNameSpaces = new SOAPClientNS();
  actionNameSpaces.add("aa", "http://www.axis.com/vapix/ws/action1" );
  actionNameSpaces.add("wsnt", "http://docs.oasis-open.org/wsn/b-2" );
  actionNameSpaces.add("tns1", "http://www.onvif.org/ver10/topics" );
  actionNameSpaces.add("tnsaxis", "http://www.axis.com/2009/event/topics" );

  // draw Gatekeeper select
  function drawGatekeeper()
  {
    if( document.motionForm.elements.length >= 1 )
    {
      var gatekeeperActionRule;
      var newGatekeeperRuleId = "";

      getGatekeeperActionRule();

      if( gatekeeperActionRule != null )
      {
        var opArr = new Array();
        opArr.push( {val: "yes", text: langObjView.getText("gatekeeperOnTxt"), selected: ((gatekeeperActionRule.Enabled == "true")?true:false)} );
        opArr.push( {val: "no", text: langObjView.getText("gatekeeperOffTxt"), selected: ((gatekeeperActionRule.Enabled != "true")?true:false)} );

        var elArr = new Array();
        elArr.push( {type: "select", name: "gatekeeperEnabled", onChange: enableGatekeeperWrapper, optionArr: opArr } );

        outputBox( langObjView.getText("gatekeeperTxt"), elArr, false, true);
      }
    }
  }

  function enableGatekeeperWrapper()
  {
    enableGatekeeper( document.getElementById("gatekeeperEnabled") );
  }

  function enableGatekeeper( selectEl )
  {
    newGatekeeperRuleId = "";
    var now = new Date();
    var timestamp = "?timestamp="+now.getTime();

    var url = "/vapix/services"+timestamp;
    var method = "aa:AddActionRule";

    var val = selectEl.options[ selectEl.selectedIndex ].value;

    var actionRuleSetup = new Object();
    actionRuleSetup.Enabled = ((val == "yes")?true:false);
    actionRuleSetup.Name = gatekeeperActionRule.Name;

    actionRuleSetup.PrimaryAction = gatekeeperActionRule.PrimaryAction;
    if( gatekeeperActionRule.FailoverAction )
    {
      actionRuleSetup.FailoverAction = gatekeeperActionRule.FailoverAction;
    }

    var conditionArray = new Array();
    var filterCondtionObj;
    if( gatekeeperActionRule.Conditions )
    {
      var conditions = gatekeeperActionRule.Conditions.Condition;
      if( conditions )
      {
        var conditionTopics = new Array();
        var conditionMessages = new Array();

        if( conditions.constructor != Array )
        {
          filterCondtionObj = getTopicFilterObject( conditions.TopicExpression["#text"], conditions.MessageContent["#text"] );
          conditionArray[ conditionArray.length ] = { "Condition":filterCondtionObj };
        }
        else
        {
          var len = conditions.length;
          for( var i = 0; i < len; i++ )
          {
            filterCondtionObj = getTopicFilterObject( conditions[i].TopicExpression["#text"], conditions[i].MessageContent["#text"] );
            conditionArray[ conditionArray.length ] = { "Condition":filterCondtionObj };
          }
        }
      }
    }
    actionRuleSetup.Conditions = conditionArray;

    var params = new SOAPClientParameters();
    params.add( "NewActionRule", actionRuleSetup );

    SOAPClient.invoke( wsdlUrl, url, actionNameSpaces, method, params, true, onEnableGatekeeper );
  }

  function getTopicFilterObject( topicStr, messageStr )
  {
    var topicFilterObject = new Array();
    var topicObj = new Object();

    var strDialect = "http://www.onvif.org/ver10/tev/topicExpression/ConcreteSet";
    strDialect = strDialect.setIsAttribute( true );
    topicObj.Dialect = strDialect;

    topicStr = topicStr.setIsObjectNodeValue( true );
    topicObj.value = topicStr;

    topicFilterObject["wsnt:TopicExpression"] = topicObj;

    if( messageStr )
    {
      var messageObj = new Object();
      strDialect = "http://www.onvif.org/ver10/tev/messageContentFilter/ItemFilter";
      strDialect = strDialect.setIsAttribute( true );
      messageObj.Dialect = strDialect;

      messageStr = messageStr.setIsObjectNodeValue( true );
      messageObj.value = messageStr;

      topicFilterObject["wsnt:MessageContent"] = messageObj;
    }
    return topicFilterObject;
  }

  function onEnableGatekeeper( responseObj )
  {
    if( responseObj )
    {
      if( responseObj.name == "Error" )
      {
        var errorMsg = ( ( responseObj.description )?responseObj.description:(responseObj.fileName)?responseObj.fileName:responseObj.message );
        alert( errorMsg );
        return;
      }
      else
      {
         newGatekeeperRuleId = responseObj.RuleID;
      }
      removeGatekeeperRule( gatekeeperActionRule.RuleID );
    }
  }

  function removeGatekeeperRule( ruleId )
  {
    var params = new SOAPClientParameters();
    params.add("RuleID", ruleId );

    var now = new Date();
    var timestamp = "?timestamp="+now.getTime();

    var url = "/vapix/services"+timestamp;
    var method = "aa:RemoveActionRule";
    SOAPClient.invoke( wsdlUrl, url, actionNameSpaces, method, params, true, onRemoveGatekeeperRule );
  }

  function onRemoveGatekeeperRule( responseObj )
  {
    if( responseObj )
    {
      if( responseObj.name == "Error" )
      {
        var errorMsg = ( ( responseObj.description )?responseObj.description:(responseObj.fileName)?responseObj.fileName:responseObj.message );
        alert( errorMsg );
        if( newGatekeeperRuleId != "" )
        {
          var ruleId = newGatekeeperRuleId;
          newGatekeeperRuleId = "";
          removeGatekeeperRule( ruleId );
          return;
        }
      }
    }//if response
    if( newGatekeeperRuleId != "" )
    {
      newGatekeeperRuleId = "";
      getGatekeeperActionRule();
    }
  }

  function getGatekeeperActionRule()
  {
    var params = new SOAPClientParameters();
    var now = new Date();
    var timestamp = "?timestamp="+now.getTime();

    var url = "/vapix/services"+timestamp;
    var method = "aa:GetActionRules";

    SOAPClient.invoke( wsdlUrl, url, actionNameSpaces, method, params, false, onGetGatekeeperActionRule );
  }

  function onGetGatekeeperActionRule( responseObj )
  {
    if( responseObj )
    {
      var actionParent = responseObj.ActionRules;
      if( actionParent )
      {
        var actionRule = actionParent.ActionRule;
        if( actionRule )
        {
          if( actionRule.constructor != Array )
          {
            if( actionRule.Name == "<!--#echo var="reservedName" option="encoding:javascript" -->" )
            {
              gatekeeperActionRule = actionRule;
            }
          }
          else
          {
            var len = actionRule.length;
            for( var i = 0; i < len ; i++ )
            {
              if( actionRule[i].Name == "<!--#echo var="reservedName" option="encoding:javascript" -->" )
              {
                gatekeeperActionRule = actionRule[i];
              }
            }
          }
        }
      }
    }//if response
  }
<!--#endif -->
<!--#endif -->



  var theTempDevice = AxisConnectionFactory.createAjaxConnection();


  function startTemperatureControl(device, id)
  {
    var now = new Date();
    AxisConnectionFactory.sendSync(["GET", "/axis-cgi/temperaturecontrol.cgi?device=" + device + "&id=" + id + "&action=start&timestamp="+now.getTime()], "", theTempDevice);
  }

<!--#set var="showSetup" val="yes" -->
<!--#if expr="$root_Layout_Axis = no" -->
  <!--#if expr="$root_Layout_SetupLinkEnabled = no" -->
    <!--#set var="showSetup" val="no" -->
  <!--#endif -->
<!--#endif -->

<!--#if expr="$showSetup = yes" -->
function setHrefForSetup()
{


  // Workaround for IE7 that doesn't handle location.host correctly with IPv6.
  var address = "";
  var axoper_new = "<!--#echo var="root_System_BoaGroupPolicy_operator" option="encoding:javascript" -->";
  var axadmin_new = "<!--#echo var="root_System_BoaGroupPolicy_admin" option="encoding:javascript" -->";

<!--#if expr="$http_user_realms >< ¤Administrator¤" -->
  var user_realm = 1;
<!--#elif expr="$http_user_realms >< ¤Operator¤" -->
  var user_realm = 2;
<!--#else -->
  var user_realm = 3;
<!--#endif -->

  var the_hostname = document.location.hostname

  <!--#if expr="$root_Network_IPv6_Enabled = yes" -->
  // Workaround for location.hostname that doesn't work with IPv6 in all browsers
  var pageurl = location.href
  if (pageurl.indexOf("[") != -1) {
    the_hostname = pageurl.substring(pageurl.indexOf("["), pageurl.indexOf("]")+1)
  }
  <!--#endif -->
  if ((document.location.protocol == 'http:') && ((((axoper_new == 'https') || (axoper_new == 'both')) && user_realm != 1 ) || ((axadmin_new == 'https') || (axadmin_new == 'both')) && user_realm == 1)) {
    var the_https_port = '<!--#echo var="root_HTTPS_Port" option="encoding:url" -->'
    address = 'https://'
    address += the_hostname
    if (the_https_port != '443') {
      address += ':' + the_https_port
    }
  }

  var addressPart2 = "";
  <!--#if expr="$root_Layout_PlainConfigEnabled = yes" -->
  addressPart2 = "/admin/config.shtml";
  <!--#else -->
    <!--#if expr="$root_Layout_EnableBasicSetup = no" -->
      <!--#if expr="$root_Brand_ProdType = Network IO Audio Module" -->
  addressPart2 = "/operator/audio.shtml";
      <!--#else -->
  addressPart2 = "/operator/videostream.shtml";
      <!--#endif -->
  addressPart2 += "?id=<!--#echo var="ssi_request_id" option="encoding:url" -->";
    <!--#else -->
  addressPart2 = "/operator/basic.shtml?id=<!--#echo var="ssi_request_id" option="encoding:url" -->";
    <!--#endif -->
  <!--#endif -->

  document.getElementById("view_SetTxt1").href = address+addressPart2;
}
<!--#endif -->

function globalLanguageVars()
{
<!--#if expr="$showSetup = yes" -->
  setHrefForSetup();
<!--#endif -->


  var qtPlayer = document.getElementById("QTPlayer"),
      amaPlayer = document.getElementById("AMAPlayer");
  if (qtPlayer == null && amaPlayer == null)
    drawScaleButtons();

<!--#if expr="$showSizeButtons != no" -->
  drawSizeButtons();
<!--#endif -->

<!--#if expr="$root_Layout_ShowVideoFormatDropDown = yes" -->
  <!--#if expr="$seq != yes" -->
    <!--#if expr="$external = no" -->
  writeFormatOptions();
    <!--#endif -->
  <!--#endif -->
<!--#endif -->




<!--#if expr="$root_Output_NbrOfOutputs != 0" -->
  drawOutputButtons();
<!--#endif -->



<!--#if expr="$root_Properties_GuardTour_RecordedTour = yes" -->
  drawRecordedTours();
<!--#endif -->

  drawSequenceButtons();
  drawTriggerButtons();

<!--#if expr="$root_Properties_TemperatureSensor_Fan = yes" -->
  <!--#if expr="$root_Layout_FanEnabled = yes" -->
  drawFanButton();
  <!--#endif -->
<!--#endif -->

<!--#if expr="$root_Properties_TemperatureSensor_Heater = yes" -->
  <!--#if expr="$root_Layout_HeaterEnabled = yes" -->
  drawHeaterButton();
  <!--#endif -->
<!--#endif -->


<!--#if expr="$root_Layout_SnapshotEnabled = yes" -->
  drawSnapshotButton();
<!--#endif -->

<!--#if expr="$operatorOrAdminUser = yes" -->
<!--#if expr="$root_PTZ_Preset_P0_HomePosition != -1" -->
  drawGatekeeper();
<!--#endif -->
<!--#endif -->

<!--#if expr="$imagepath = " -->
  goto_camera('<!--#echo var="root_Layout_LiveViewVideo" option="encoding:javascript" -->');
<!--#endif -->

  document.getElementById("view_HelpTxt").innerHTML = langObjView.getText("helpTxt");
  document.getElementById("view_LViewTxt").innerHTML = langObjView.getText("lViewTxt");
  document.getElementById("view_SetTxt1").innerHTML = langObjView.getText("settTxt");

}

<!--#if expr="$root_Properties_PTZ_PTZ = yes" -->
function extractVideoNbr(theParamPos)
{
  var i = 0;
  var start, stop;
  var len;
  var colonCount = 0;

  while (theParamPos.charAt(i++) != '~' && i < theParamPos.length);
  if (i >= theParamPos.length) {
    return -1;
  }
  while (colonCount < 6 && i < theParamPos.length) {
    if (theParamPos.charAt(i++) == ':') {
      colonCount++;
      if (colonCount == 4)
        start = i;
      if (colonCount == 5)
        len = i-2-start+1;
    }
  }
  if (i < theParamPos.length && len > 0)
    return parseInt(theParamPos.substr(start,len), 10);
  else
   return -1;
}

function extractPresetNbr(name)
{
  var nbr = name.slice(20, -4)
  return parseInt(nbr, 10)
}
<!--#endif -->

function getNewImageSource( camera_nbr )
{
  var imageSource;
<!--#if expr="$fmt = mpeg4+" -->
  imageSource = "/axis-media/media.amp?videocodec=mpeg4"+(( camera_nbr != null && camera_nbr != "" )?"&camera=" + camera_nbr:"");
<!--#elif expr="$fmt >< h264+" -->
  imageSource = "/axis-media/media.amp?videocodec=h264"+(( camera_nbr != null && camera_nbr != "" )?"&camera=" + camera_nbr:"");
<!--#else -->
  imageSource = "/mjpg/"+(( camera_nbr != null && camera_nbr != "" )? camera_nbr + "/":"")+"video.mjpg"+(( camera_nbr != null && camera_nbr != "" )?"?camera=" + camera_nbr:"");
<!--#endif -->

  return imageSource;
}


function listVideoSources()
{
  var formInt = document.listFormInt;
  var formExt = document.listFormExt;
  var formCrop = document.listFormCrop;
  var presetForm = document.listFormPreset;
  var form = document.WizardForm
  var currentPath = '<!--#echo var="imagepath" option="encoding:none" -->';
  var imageSource;
  var opArr = new Array();
  var opSelected = false;
  var opVal = "";
  var opText = "";

  if ((<!--#echo var="root_ImageSource_NbrOfSources" option="encoding:javascript" --> > 1)
<!--#if expr="$ptzpresets = yes" -->
        || presetForm.elements.length > 0
<!--#endif -->
      || ext_sources > 0
     ) {

    if ((<!--#echo var="root_ImageSource_NbrOfSources" option="encoding:javascript" --> == 1)
<!--#if expr="$ptzpresets = yes" -->
          && (presetForm.elements.length > 0)
<!--#endif -->
        && ext_sources == 0
       ) {
      opArr.push( {val: "no_change", text: "----------------"} );
    }
    else
    {

      for (i = 0; i < <!--#echo var="root_ImageSource_NbrOfSources" option="encoding:javascript" -->; i++) {
        var camera_nice_nbr = i + 1;
        imageSource = getNewImageSource( <!--#if expr="$root_ImageSource_NbrOfSources != 1" -->camera_nice_nbr<!--#endif --> );

        opSelected = false;
        if (imageSource == currentPath ||
            '/jpg/<!--#if expr="$root_ImageSource_NbrOfSources != 1" -->' + camera_nice_nbr + '/<!--#endif -->image.jpg' == currentPath)
        {
          opSelected = true;
        }
        opArr.push( {val: imageSource, text: formInt['root_ImageSource_I' + i + '_Name'].value, selected: opSelected} );
      }
    }

<!--#if expr="$ptzpresets = yes" -->
    // ***** PTZ presets *****
    var prevReqCam = 1;
    if (currentPath.indexOf("camera") != -1) {
      var tmpStr = currentPath.substring(currentPath.indexOf("camera")+7);
      prevReqCam = (tmpStr.indexOf("&") != -1 )?tmpStr.substr(0, tmpStr.indexOf("&") ):tmpStr.substr(0);
    }
    var curpreset = unescape("<!--#echo var="gotopresetname" option="encoding:javascript" -->");
    if (currentPath.indexOf("gotopresetname") != -1) {
      if (currentPath.lastIndexOf("&") > currentPath.lastIndexOf("gotopresetname="))
        curpreset = unescape(currentPath.substring(currentPath.lastIndexOf("gotopresetname=")+15, currentPath.lastIndexOf("&")-1))
      else
        curpreset = unescape(currentPath.substr(currentPath.lastIndexOf("gotopresetname=")+15))
    }
    for (i = 0; i < <!--#echo var="root_ImageSource_NbrOfSources" option="encoding:javascript" -->; i++) {
      if (presetForm.elements.length >= 0) {
        for (var j = 0; j < presetForm.elements.length; j++) {
          var tmpArray = presetForm.elements[j].name.split("_");
        <!--#include virtual="/sm/sm.srv?action=get&group=PTZ.Preset.P$nbr$.HomePosition" -->
          if (tmpArray[tmpArray.length - 1] == "Name") {
            var label = escape(presetForm[j].value);
            var currentPresetId = String( presetForm.elements[j].name ).replace("root_PTZ_Preset_P", "").split("_")[0];

            if (currentPresetId != i) {
              continue;
            }
            var videoNbr = i + 1;
            var group = tmpArray[tmpArray.length - 2];

            if (videoNbr-1 == i)
            {
  <!--#if expr="$external = no" -->
                var tmpOpt = 'gotopresetname=' + label;

                if (currentPath.indexOf('?') >= 0)
                  tmpOpt = '&' + tmpOpt;
                else
                  tmpOpt = '?' + tmpOpt;

                opSelected = false;
                opVal = currentPath + tmpOpt;

  <!--#else -->
    <!--#if expr="$root_Layout_DefaultVideoFormat = mpeg4" -->
                  var imageSource = "/axis-media/media.amp?videocodec=mpeg4&";
    <!--#elif expr="$root_Layout_DefaultVideoFormat = h264" -->
                  var imageSource = "/axis-media/media.amp?videocodec=h264&";
    <!--#else -->
                  var imageSource = "/axis-cgi/mjpg/video.cgi?"
    <!--#endif -->
                imageSource += "camera=" + videoNbr + "&gotopresetname=" + label;

                opVal = imageSource;
  <!--#endif -->
              if (unescape(label) == curpreset && videoNbr == prevReqCam)
                opSelected = true;
              opText = formInt['root_ImageSource_I' + i + '_Name'].value.crop(25, "...") + "&nbsp;-&nbsp;";

              var homeGrp = "P<!--#echo var="root_PTZ_Preset_P$nbr$_HomePosition" option="encoding:javascript" -->";
              if (group == homeGrp)
              {
                label += ' (H)';
              }
              opText = unescape(label).crop(25, "...");
              opArr.push( {val: opVal, text: opText, selected: opSelected} );
            }//if videoNbr-1 == i
          }
        }
      }
    }

<!--#endif -->
var viewAppletIE = <!--#if expr="$root_Layout_ViewerIE = java" -->"yes"<!--#else -->"no"<!--#endif -->;
var viewAppletOther = <!--#if expr="$root_Layout_ViewerOther = java" -->"yes"<!--#else -->"no"<!--#endif -->;
// Don't show external sources while using Java applet as Default Viewer. An unsigned applet doesn't have permission to access remote hosts.
    if (((browser == "IE") && (viewAppletIE == "no")) || ((browser != "IE") && (viewAppletOther == "no")))
    {
      if (formExt.elements.length > 0)
      {
        for (i = 0; i < formExt.elements.length; i += 3)
        {
          var aTempString = formExt.elements[i].name
          var videoNr = aTempString.substring(20, aTempString.lastIndexOf('_'))
          var external = formExt['root_ExternalVideo_E' + videoNr + '_ImagePath'].value;

            opSelected = false;

            if (formExt['root_ExternalVideo_E' + videoNr + '_ImagePath'].value == currentPath)
              opSelected = true;
            opArr.push( {val: external, text: formExt['root_ExternalVideo_E' + videoNr + '_Name'].value, selected: opSelected} );
        }
      }
    }

    var extraButton = document.createElement("input");
    extraButton.type = "button";
    extraButton.value = langObjView.getText("goBtn");
    extraButton.onclick = selectView;
    extraButton.width = "40";

    return {type: "select", name: "videoList", onChange: selectView, optionArr: opArr, disabled: <!--#if expr="$seq = yes" -->true<!--#else -->false<!--#endif -->, extraCode: extraButton };
  }

  return null;
}

function zoom(size)
{
  var url = document.URL;

  if (url.indexOf("?") == -1) {
    url += "?size=" + size
  } else if (url.indexOf("size=") == -1) {
    url += "&size=" + size
  } else {
    var searchStr = "size=<!--#echo var="size" option="encoding:javascript" -->"
    var replaceStr = "size=" + size
    var re = new RegExp(searchStr , "g")
    url = url.replace(re, replaceStr)
  }

  document.location = url;
}

var aNewImagePath;

function reloadPage()
{
  document.location = aNewImagePath;
}

<!--#if expr="$ptzpresets = yes" -->
  var gotopresetname = unescape('<!--#echo var="gotopresetname" option="encoding:javascript" -->');
<!--#endif -->

function selectView()
{
  var form = document.WizardForm;


  var oVideoList = form.videoList;
  var source = "no_change";
  if( oVideoList && oVideoList.selectedIndex >= 0 )
  {
    source = oVideoList.options[oVideoList.selectedIndex].value;
  }
  var params = source.split('&');
  var newCamera = null;
  var presetName = null;

  if ((params[1] != null) && ("<!--#echo var="external" option="encoding:javascript" -->" == "no")) {
    if (source.lastIndexOf("camera=") != -1) {
      newCamera = source.substr(source.lastIndexOf("camera=")+7);
      if (newCamera.indexOf("&") != -1) {
        newCamera = newCamera.substring(0, newCamera.indexOf("&"));
      }
    }
    else {
      newCamera = 1;
    }

    if (source.lastIndexOf("gotopresetname=") != -1) {
      presetName = source.substr(source.lastIndexOf("gotopresetname=")+15);
      if (presetName.indexOf("&") != -1 ) {
        presetName = presetName.substring(0, presetName.indexOf("&"));
      }
    }
    source = params[0];
    for (var p = 1; p < params.length; p++)
    {
      if (params[p].indexOf("gotopreset") == -1)
        source += "&" + params[p];
    }
  }
  else if (source.lastIndexOf("gotopresetname=") != -1) {
    presetName = source.substr(source.lastIndexOf("gotopresetname=")+15);
    newCamera = 1;

    params = source.split('?');
    source = params[0];
  }
  else if (source == "no_change")
  {
    return;
  }

  if (presetName != null) gotopresetname = presetName;

  var opt = null;
  <!--#if expr="_$streamprofile != _" -->
  opt = "&streamprofile=<!--#echo var="streamprofile" option="encoding:javascript" -->";
  <!--#endif -->

  source = unescape( source );

  changeView(source, newCamera, presetName, null, opt);
}

function changeView(imagePath)
{
  var args = changeView.arguments;
  var newCamera  = (args.length >= 2 ? args[1] : null);
  var presetName = (args.length >= 3 ? args[2] : null);
  var newSize    = (args.length >= 4 ? args[3] : null);
  var other      = (args.length >= 5 ? args[4] : null);

  // Go to correct preset when coming from an external video source
  if ((presetName == null || presetName == "") && (imagePath.indexOf("gotopresetname=") != -1)) {
    presetName = imagePath.slice(imagePath.indexOf("gotopresetname=") + 15)
    if (presetName.indexOf("&") != -1)
      presetName = presetName.substring(0, presetName.indexOf("&"))
  }
  if ((newCamera == null || newCamera == "") && (imagePath.indexOf("camera=") != -1)) {
    newCamera = imagePath.slice(imagePath.indexOf("camera=") + 7)
    if (newCamera.indexOf("&") != -1)
      newCamera = newCamera.substring(0, newCamera.indexOf("&"))
  }

  var reload = false;
<!--#if expr="$seq != yes" -->
  // the whole Live View design is built on page reload >-(
  // must reload initial sequence mode view to toggle buttons etc
  reload |= (other != null && other.search("seq=yes") >= 0);
<!--#endif -->
      reload |= (other != null && other.search("streamprofile=") >= 0);
      reload |= ((other == null || (other != null && other.search("streamprofile=") == -1)) && ('<!--#echo var="streamprofile" option="encoding:url" -->' != ""));
  reload |= (imagePath != '<!--#echo var="imagepath" option="encoding:url" -->');


<!--#if expr="$ptzpresets = yes" -->
  if ((presetName != null) && (presetName != "")) {
    var prevCamera = '<!--#echo var="camnbr" option="encoding:javascript" -->';
    // set new image path
    if (prevCamera == 'quad') {
      imagePath = imagePath.replace(/quad/, newCamera);
      reload = true;
    } else if (prevCamera != newCamera) {
      imagePath = imagePath.replace("/" + prevCamera + "/", "/" + newCamera + "/");
      reload = true;
    }
    else {
      reload = false;
    }
      gotoPreset(newCamera, presetName);
  }
<!--#endif -->
  if (reload) {
    var size = newSize;

    if (size == null) {
<!--#if expr="_$size != _" -->
      size = <!--#echo var="size" option="encoding:javascript" -->;
<!--#endif -->
    }
    if (size != null) {
      size = '&size=' + size;
    }
    aNewImagePath = '/view/view.shtml?id=<!--#echo var="ssi_request_id" option="encoding:url" -->&imagePath=' + escape(imagePath) + size;
    if (other != null)
      aNewImagePath += other;
<!--#if expr="$ptzpresets = yes" -->
    /* append preset parameters so that preset postion is selected in drop down list after reload */
    if (presetName != '' && presetName != null)
      aNewImagePath += "&gotopresetname=" + escape(presetName);
    else if (gotopresetname != '' && gotopresetname != null)
      aNewImagePath += "&gotopresetname=" + escape(gotopresetname);

    if( newCamera != '' && newCamera != null )
      aNewImagePath += "&camera=" + escape(newCamera);

<!--#endif -->
    reloadPage();
  }
<!--#if expr="$ptzpresets = yes" -->
  else if (other != null) {
    selectSource(newCamera, presetName);
  }
<!--#endif -->
}

<!--#if expr="$ptzpresets = yes" -->
var ajaxRequest = AxisConnectionFactory.createAjaxConnection();
ajaxRequest.setOverrideMimeType("text/plain");
function gotoPreset(camera, presetName)
{
  var now = new Date();

  <!--#if expr="_$camnbr != _" -->
    <!--#set var="idx" val="$camnbr$" -->
  <!--#else -->
    <!--#set var="idx" val="1" -->
  <!--#endif -->


  var speed = parseInt("<!--#if expr="_$(root_PTZ_UserAdv_U$idx$_MoveSpeed) != _" --><!--#echo var="root_PTZ_UserAdv_U$idx$_MoveSpeed" option="encoding:javascript" --><!--#else -->70<!--#endif -->", 10);

  var url = "/axis-cgi/com/ptz.cgi?gotoserverpresetname=" + presetName + "&camera=" + camera + "&timestamp="+now.getTime() <!--#if expr="_$(root_PTZ_Various_V$idx$_SpeedCtlEnabled) != _" --><!--#if expr="$(root_PTZ_Various_V$idx$_SpeedCtlEnabled) = true" --> +"&speed=" + speed<!--#endif --><!--#endif -->;

  if (ajaxRequest.getReadyState() > 0 || ajaxRequest.getReadyState() < 4)
    ajaxRequest.abort();

  AxisConnectionFactory.sendAsync(["GET", url], "", ajaxRequest_onchange, ajaxRequest);
}

function ajaxRequest_onchange()
{
  if (typeof(ajaxRequest) == 'object' && ajaxRequest.getReadyState() == 4) {
    try {
      if (ajaxRequest.getStatus() == 200 && ajaxRequest.getResponseText().length > 0)
      {
        var errorMessage;
        var responseText = ajaxRequest.getResponseText();
        if(responseText.indexOf("<HTML>") != -1 || responseText.indexOf("<html>") != -1)
        {
          var headStartPos = responseText.indexOf("<HEAD>");
          if(headStartPos == -1)
            headStartPos = responseText.indexOf("<head>");
          var headEndPos = responseText.indexOf("</HEAD>")+7;
          if(headEndPos == -1)
            headEndPos = responseText.indexOf("</head>")+7;

          responseText = responseText.replace(responseText.slice(headStartPos, headEndPos),"");
          var re= /<\S[^>]*>/g;
          errorMessage = responseText.replace(re,"");
        }
        else
          errorMessage = responseText;

        alert(errorMessage);
      }
    } catch(e) {}
  }
}

function selectSource(newCamera, presetName) {
  var options = document.WizardForm.videoList.options;
  var i = 0;
  var option;

  while ((option = options[i++]) != null) {
    if (presetName != null) {
      var presetStart = option.value.search('gotopresetname');
      if (presetStart != -1) {
        var preset = option.value.substring(presetStart).split('=');
        if (unescape(preset[1]) == presetName) {
          option.selected = true;
          return;
        }
      }
    } else {
      var videoNbr = option.value.match(/\d/);
      if (videoNbr == null && newCamera == 1 || videoNbr == newCamera) {
        option.selected = true;
        return;
      }
    }
  }
}
<!--#endif -->

var seqNext = null;

function doSequence(size) {
  var formSeq = document.listFormSeq;
  var formExt = document.listFormExt;
  var presetForm = document.listFormPreset;
  var seqSources = new Array();
  var seqNumbers = new Array();
  var seqTimes = new Array();
  var cameraNbr;
  var presetName = null;
  var imagePath;
  var next;

  for (var i = 0; i < formSeq['root_Sequence_S0_NbrOfSources'].value; i++) {
    seqSources[i] = formSeq['root_Sequence_S0_Source_S' + i + '_Type'].value;
    seqNumbers[i] = formSeq['root_Sequence_S0_Source_S' + i + '_Number'].value;
    seqTimes[i] = formSeq['root_Sequence_S0_Source_S' + i + '_Time'].value;
  }

  if (seqNext != null) {
    next = seqNext;
  } else {
<!--#if expr="_$next = _" -->
    next = 0;
<!--#else -->
    next = <!--#echo var="next" option="encoding:javascript" -->;
<!--#endif -->
  }

  imagePath = "";
  if (seqSources[next] == 'Ext') {
    imagePath = formExt['root_ExternalVideo_E' + seqNumbers[next] + '_ImagePath'].value;
  }
<!--#if expr="$ptzpresets = yes" -->
  else if (seqSources[next] == 'Preset') {
    cameraNbr = 1
    presetName = presetForm['root_PTZ_Preset_P0_Position_P' + seqNumbers[next] + '_Name'].value;
  }
<!--#endif -->
  else if (seqSources[next] == 'Quad') {
    cameraNbr = 'quad';
  } else {
    cameraNbr = parseInt(seqNumbers[next], 10) + 1;
  }

  if (imagePath == "") {
<!--#if expr="$root_Layout_DefaultVideoFormat = mpeg4" -->
      imagePath = '/axis-media/media.amp?videocodec=mpeg4&camera=' + cameraNbr;
<!--#elif expr="$root_Layout_DefaultVideoFormat = h264" -->
      imagePath = '/axis-media/media.amp?videocodec=h264&camera=' + cameraNbr;
<!--#else -->
      imagePath = '/mjpg/' + cameraNbr + '/video.mjpg';
<!--#endif -->
  }

  var nextNext;
  if (formSeq['root_Sequence_S0_RandomEnabled'].value == "yes")
    nextNext = Math.floor(Math.random() * formSeq['root_Sequence_S0_NbrOfSources'].value);
  else
    nextNext = next + 1;
  if (nextNext >= formSeq['root_Sequence_S0_NbrOfSources'].value)
    nextNext = 0;

  seqNext = nextNext;
    changeView(imagePath, cameraNbr, presetName, size, '&seq=yes&next=' + nextNext + '&sequencetime=' + seqTimes[next]);

    t1 = setTimeout("doSequence(" + size + ")", 1000 * seqTimes[next]);
}


function snapshot(imagepath)
{
  var no = document.WizardForm.amount.value++
  var picturepath;
  var protEnd = imagepath.indexOf("://");
  var camIndex = imagepath.indexOf("camera=");

  if (imagepath.charAt(0) == '/' && protEnd < 0) {
    if (camIndex >= 0) {
      var secondEt = imagepath.indexOf('&', camIndex);
      var camnbr = imagepath.substring(camIndex + 7, (secondEt >= 0 ? secondEt : imagepath.length));
    } else {
      var afterfirstSlash = imagepath.indexOf('/', 1) + 1;
      var secondSlash = imagepath.indexOf('/', afterfirstSlash);
      var camnbr = imagepath.substring(afterfirstSlash, (secondSlash >= 0 ? secondSlash : imagepath.length));
    }
    if (camnbr != "quad" && isNaN(parseInt(camnbr, 10)))
      camnbr = 1;
    picturepath = "/jpg/" + camnbr + "/image.jpg";
  } else {
    if (imagepath.indexOf("h264") >= 0 || imagepath.indexOf("mpeg4") >= 0) {
      var prot = document.location.protocol;
      var imageHost = imagepath.substring(protEnd + 3, imagepath.indexOf('/', protEnd+3));
      var secondEt = imagepath.indexOf('&', camIndex);
      var camnbr = imagepath.substring(camIndex + 7, (secondEt >= 0 ? secondEt : imagepath.length));
      if (camnbr != "quad" && isNaN(parseInt(camnbr, 10)))
        camnbr = 1;
      picturepath = prot + "//" + imageHost + "/jpg/" + camnbr + "/image.jpg";
    } else {
      picturepath = imagepath.replace(/video/, "image").replace(/mjpg/g, "jpg");
    }
  }


  var pictureoptions = "";
<!--#if expr="$invalidProfile != yes" -->
  <!--#if expr="_$streamprofile != _" -->
    pictureoptions += "&streamprofile=<!--#echo var="streamprofile" option="encoding:javascript" -->";
  <!--#endif -->
<!--#endif -->
<!--#if expr="_$palette != _" -->
  pictureoptions += "&palette=<!--#echo var="palette" option="encoding:javascript" -->";
<!--#endif -->
  var page = 'snapshot.shtml?picturepath=' + picturepath + pictureoptions;
  var time = new Date()
  var timestamp = time.getTime()

  page += '&timestamp=' + timestamp + '&width=' + <!--#echo var="snapshotWidth" option="encoding:javascript" -->
  openPopUp(page, 'Take_snapshot' + [no] + '', <!--#echo var="snapshotWidth" option="encoding:javascript" --> + 45, <!--#echo var="snapshotHeight" option="encoding:javascript" --> + 75 )
}

<!--#if expr="$root_Properties_PTZ_PTZ = yes" --><!--#include virtual="/incl/statusPtz.shtml" --><!--#endif -->
function movepic(img_name, img_src)
{
  var element = document.getElementById(img_name+"_link");
  if (element)
    element.firstChild.src = img_src;
}

function auto(Path)
{
  parent.frames[1].location = Path
}

function AbsoluteOrRelative(form)
{
  var url = document.URL;
  var relative = "yes_no_cross";
  var oAbsOrRel = form.AbsOrRel;
  if ( oAbsOrRel && oAbsOrRel.selectedIndex == 0)
    relative = "no";
  if (url.indexOf("?") == -1) {
    url += "?relative=" + relative;
  } else if (url.indexOf("relative=") == -1) {
    url += "&relative=" + relative;
  } else {
    var searchStr = "relative=<!--#echo var="relative" option="encoding:javascript" -->";
    var replaceStr = "relative=" + relative;
    var re = new RegExp(searchStr , "g");
    url = url.replace(re, replaceStr);
  }
  document.location = url;
}


<!--#include virtual="/incl/video.shtml" -->

function goto_camera(cam)
{
  cam += ''; // cam value needs to be a string, not an integer, for cam.length to work.
<!--#if expr="$root_ImageSource_NbrOfSources = 1" -->
  cam = '';
<!--#endif -->

  var imagePath;
  newVideoFormatCam(cam);
}


<!--#set var="usingStreamProfiles" val="true" -->
function getStreamProfileNbr()
{
<!--#if expr="$root_Layout_ShowVideoFormatDropDown = yes" -->
  var videoFormat = "MJPEG";
  var oVideoFormat = document.WizardForm.videoFormat;
  if( oVideoFormat && oVideoFormat.selectedIndex >= 0 )
  {
    videoFormat = oVideoFormat.options[ oVideoFormat.selectedIndex ].value;
  }
  return videoFormat;
<!--#else -->
  return getProfileGrp(document.profileForm,"<!--#echo var="root_Layout_DefaultStreamProfile" option="encoding:javascript" -->");
<!--#endif -->
}

function getStreamProfileName()
{
  try {
    var nbr = getStreamProfileNbr();
    return ( isNaN( nbr )?"":document.profileForm["root_StreamProfile_S" + nbr + "_Name"].value );
  }
  catch(e) {
    alert( langObjView.getText("proNoVaAlrt") );
  }
}

function getStreamProfileParameters()
{
  try {
    var nbr = getStreamProfileNbr();
    return ( isNaN( nbr )?"":document.profileForm["root_StreamProfile_S" + nbr + "_Parameters"].value );
  }
  catch(e) {
    alert( langObjView.getText("proNoVaAlrt") );
  }
}
// -->
</script>

<!--#if expr="$external = no" -->
<!--#if expr="$camnbr = quad" -->

<script language="JavaScript">
<!--

var img_width = <!--#echo var="img_width" option="encoding:javascript" --> * <!--#echo var="size" option="encoding:javascript" -->;
var img_height = <!--#echo var="img_height" option="encoding:javascript" --> * <!--#echo var="size" option="encoding:javascript" -->;

document.write('<map name="QuadMap">');
document.write('<area SHAPE="RECT" COORDS="0,0,' + [img_width/2-1] + ',' + [img_height/2-1] +'" ');
document.write('HREF="javascript:goto_camera(1)" TARGET="" title="Video 1">');
document.write('<area SHAPE="RECT" COORDS="' + [img_width/2] + ',0,' + img_width + ',' + [img_height/2-1] + '" ');
document.write('HREF="javascript:goto_camera(2)" TARGET="" title="Video 2">');
document.write('<area SHAPE="RECT" COORDS="0,' + [img_height/2] + ',' + [img_width/2-1] + ',' + img_height + '" ');
document.write('HREF="javascript:goto_camera(3)" TARGET="" title="Video 3">');
document.write('<area SHAPE="RECT" COORDS="' + [img_width/2] + ',' + [img_height/2] + ',' + img_width + ',' + img_height + '" ');
document.write('HREF="javascript:goto_camera(4)" TARGET="" title="Video 4">');
document.write('</map>');

// -->
</script>

<script language="JavaScript" FOR="Player" EVENT="OnMouseDown(nButton,nShift,X,Y)">
<!--
if (nButton == 1)
{
  var cam;

  if (X < <!--#echo var="img_width" option="encoding:javascript" --> * <!--#echo var="size" option="encoding:javascript" --> / 2) {
    cam = 1;
  } else {
    cam = 2;
  }

  if (Y >= <!--#echo var="img_height" option="encoding:javascript" --> * <!--#echo var="size" option="encoding:javascript" --> / 2) {
    cam += 2;
  }

  goto_camera(cam);
}
// -->
</script>

<!--#endif --><!-- $camnbr = quad -->
<!--#endif --><!-- $external = no -->

<script SRC="/incl/activeX.js?id=<!--#echo var="ssi_request_id" option="encoding:url" -->"></script>
  <!--#if expr="$root_Properties_GuardTour_RecordedTour = yes" -->
    <script type="text/javascript" src="/incl/guardtour_class.js?ver=<!--#echo var="root_Properties_Firmware_Version" option="encoding:url" -->"></script>
  <!--#endif -->
</head>

<!--#if expr="$root_Layout_BGPicture_Source = default" -->
  <!--#set var="root_Layout_BGPicture_Source" val="none" -->
<!--#endif -->

<!--#set var="onload" value="" -->
<!--#set var="onresize" value="" -->
<!--#if expr="$showPTZBars = yes" --><!--#if expr="$external = no" -->
<!--#set var="onload" value="$onload$init();" -->
<!--#if expr="$root_Properties_GuardTour_RecordedTour = yes" -->
<!--#set var="onload" value="$onload$guardTours_load();" -->
<!--#endif -->
<!--#set var="onresize" value="$onresize$init();" -->
<!--#endif --><!--#endif -->

<body class="bodyBg" topmargin="0" leftmargin="15" marginwidth="0"  marginheight="0" <!--#if expr="$root_Brand_ProdType = Network IO Audio Module" -->onLoad="langObjView.init();UpdateIO();"<!--#endif --> <!--#if expr="$root_Layout_Axis = no" --><!--#if expr="$root_Layout_BGPicture_Source != none" -->   background="<!--#if expr="$root_Layout_BGPicture_Source = own" -->/local/<!--#echo var="root_Layout_BGPicture_Path" option="encoding:javascript" --><!--#else --><!--#echo var="root_Layout_BGPicture_Address" option="encoding:javascript" --><!--#endif -->"<!--#endif --><!--#endif --> onLoad="langObjView.init();DrawTB('<!--#echo var="UseAudio" option="encoding:javascript" -->', '<!--#echo var="imagepath" option="encoding:javascript" -->', '<!--#echo var="camnbr" option="encoding:javascript" -->', '<!--#echo var="root_Layout_AMCRecordMedia" option="encoding:javascript" -->', 'no', '<!--#if expr="$showPTZCrosshair = no" -->no<!--#else --><!--#echo var="showPTZBars" option="encoding:javascript" --><!--#endif -->', '<!--#echo var="root_PTZ_Support_S$camnbr$_JoyStickEmulation" option="encoding:javascript" -->'<!--#if expr="$usingStreamProfiles = true" -->, getStreamProfileNbr()<!--#if expr="_$streamprofile != _" -->, getStreamProfileName()<!--#endif --><!--#endif -->);dynamicResize();<!--#echo var="onload" option="encoding:javascript" -->" onresize="dynamicResize();<!--#echo var="onresize" option="encoding:javascript" -->">

<script language="JavaScript">
<!--
  var t1;
<!--#if expr="$seq = yes" -->
  var size;
  <!--#if expr="_$size = _" -->
  size = 1;
  <!--#else -->
  size = <!--#echo var="size" option="encoding:javascript" -->;
  <!--#endif -->
  t1 = setTimeout("doSequence(size)", 1000*<!--#echo var="sequencetime" option="encoding:javascript" -->);
  var seqOn = "yes";
<!--#else -->
  var seqOn = "no";
<!--#endif -->

function sequence()
{
  var size;
  if (seqOn == 'no') {
    seqOn = 'yes';
<!--#if expr="_$size = _" -->
    size = 1;
<!--#else -->
    size = <!--#echo var="size" option="encoding:javascript" -->;
<!--#endif -->
    doSequence(size);
  } else {
    clearTimeout(t1);
    seqOn = 'no';
    link = document.URL;
    if (link.indexOf('seq=yes' != -1)) {
      var regexp = /seq=yes&/;
      link = link.replace(regexp, "");
    }
    document.location = link;
  }
  return;
}

// -->
</script>


<!--#if expr="$operatorOrAdminUser = yes" -->
<form name="motionForm">
  <!--#include virtual="/sm/sm.srv?action=get_htmlform&getgroup=root.Motion&format=hiddenhtmlform" -->
</form>
<!--#endif -->


<form name="profileForm">
<!--#include virtual="/sm/sm.srv?action=get_htmlform&getgroup=root.StreamProfile&format=hiddenhtmlform" -->
</form>
<form name="listFormInt">
<!--#include virtual="/sm/sm.srv?action=get_htmlform&getgroup=root.ImageSource&format=hiddenhtmlform" -->
</form>

<form name="listFormCrop">
</form>

<form name="listFormExt">
<!--#include virtual="/sm/sm.srv?action=get_htmlform&getgroup=root.ExternalVideo&format=hiddenhtmlform" -->
</form>

<script language="JavaScript">
<!--

// Calculate the number of external sources that are supported by this browser
var ext_sources = 0;
ext_sources = document.listFormExt.elements.length/3;
// -->
</script>

<!--#if expr="$ptzpresets = yes" -->
<form name="listFormPreset">
    <!--#include virtual="/sm/sm.srv?action=get_htmlform&getgroup=root.PTZ.Preset.P$nbr$.Position&format=hiddenhtmlform" -->
</form>
<!--#endif -->

<form name="listFormSeq">
<!--#include virtual="/sm/sm.srv?action=get_htmlform&getgroup=root.Sequence&format=hiddenhtmlform" -->
</form>

<script language="JavaScript">
<!--

// Calculate the number of sequence sources that are supported by this browser
var seq_sources = 0;
if (document.listFormSeq.elements.length > 0 )  {
  if (browser == "IE") {
    seq_sources = document.listFormSeq['root_Sequence_S0_NbrOfSources'].value;
  } else {
    for (var i = 0; i < document.listFormSeq['root_Sequence_S0_NbrOfSources'].value; i++) {
      var type = document.listFormSeq['root_Sequence_S0_Source_S' + i + '_Type'].value;
      if (type != 'Ext') {
        seq_sources++;
      } else {
        var num = document.listFormSeq['root_Sequence_S0_Source_S' + i + '_Number'].value;
        var path = document.listFormExt['root_ExternalVideo_E' + num + '_ImagePath'].value;
        if ((path.indexOf("mpeg4") == -1) || (path.indexOf("h264") == -1)) {
          seq_sources++;
        }
      }
    }
  }
}
// -->
</script>


<form name="outputsForm">
  <!--#include virtual="/sm/sm.srv?action=get_htmlform&getgroup=root.IOPort&format=hiddenhtmlform" -->
</form>



  <form name="UploadedFilesForm">
  <!--#include virtual="/axis-cgi/viewer/local_list.cgi?hdgen=no" -->
  </form>

<table width="100%" cellspacing=0 cellpadding=0 border=0><tr><td align="center">
<form name="WizardForm" method="post">
    <input type="hidden" name="root_Layout_Trigger_T0_Enabled" value="<!--#echo var="root_Layout_Trigger_T0_Enabled" option="encoding:html" -->" />

  <input type="hidden" name="amount" value="0" />

  <br>
  <table width=778 cellspacing=0 cellpadding=0 border=0>
    <tr class="top-mainborder">
      <td colspan=2><img src="/pics/line_corner_lt_5x5px.gif" width=5 height=5 border=0 alt=""></td>
      <td background="/pics/line_t_100x5px.gif"><img src="/pics/line_t_100x5px.gif" width=768 height=5 border=0 alt=""></td>
      <td colspan=2><img src="/pics/line_corner_rt_5x5px.gif" width=5 height=5 border=0 alt=""></td>
    </tr>
    <tr>
      <td class="lineBg"><img src="/pics/blank.gif" width="1" border=0 alt=""></td>
      <td><img src="/pics/blank.gif" width="4" height=1 border=0 alt=""></td>
      <td valign="middle" align="left" width="100%">
        <table border=0 cellspacing=0 cellpadding=0 width="100%">
          <tr>

<!--#if expr="$root_Layout_Axis = no" -->
  <!--#if expr="$root_Layout_Logo_Link = default" -->
    <!--#set var="root_Layout_Logo_LinkURL" val="http://www.axis.com/" -->
  <!--#endif -->
  <!--#if expr="$root_Layout_Logo_Source = default" -->
    <!--#set var="root_Layout_Logo_Address" val="/pics/logo_70x29px.gif" -->
  <!--#endif -->
  <!--#if expr="$root_Layout_Logo_Source = own" -->
    <!--#set var="root_Layout_Logo_Address" val="/local/$root_Layout_Logo_Path$" -->
  <!--#endif -->

  <!--#if expr="$root_Layout_Banner_Link = default" -->
    <!--#set var="root_Layout_Banner_LinkURL" val="http://www.axis.com/" -->
  <!--#endif -->
  <!--#if expr="$root_Layout_Banner_Source = default" -->
    <!--#set var="root_Layout_Banner_Address" val="/pics/banner_top.gif" -->
  <!--#endif -->
  <!--#if expr="$root_Layout_Banner_Source = own" -->
    <!--#set var="root_Layout_Banner_Address" val="/local/$root_Layout_Banner_Path$" -->
  <!--#endif -->

            <td><!--#if expr="$root_Layout_Logo_Link != none" --><a href="<!--#echo var="root_Layout_Logo_LinkURL" option="encoding:html" -->" target=_blank><!--#endif --><!--#if expr="$root_Layout_Logo_Source != none" --><img src="<!--#echo var="root_Layout_Logo_Address" option="encoding:html" -->" border=0><!--#endif --><!--#if expr="$root_Layout_Logo_Link != none" --></A><!--#endif --></td>
            <td><!--#if expr="$root_Layout_Banner_Link != none" --><a href="<!--#echo var="root_Layout_Banner_LinkURL" option="encoding:html" -->" target=_blank><!--#endif --><!--#if expr="$root_Layout_Banner_Source != none" --><img src="<!--#echo var="root_Layout_Banner_Address" option="encoding:html" -->" border=0><!--#endif --><!--#if expr="$root_Layout_Banner_Link != none" --></A><!--#endif --></td>
<!--#else -->
          <td>
  <script language="JavaScript" type="text/javascript">
  <!--
    for (i=0; i<document.UploadedFilesForm.length; i++) {
      if (document.UploadedFilesForm.elements[i].value.indexOf("viewer/extraLogo_left.") != -1) {
        document.write('<img src="/local/'+document.UploadedFilesForm.elements[i].value+'">&nbsp;');
        break;
      }
    }
  -->
  </script>
          <a href="http://www.axis.com/" target=_blank><img src="/pics/logo_70x29px.gif" width=68 height=29 border=0 title="Axis" alt="Axis"></a>
  <script language="JavaScript" type="text/javascript">
  <!--
    for (i=0; i<document.UploadedFilesForm.length; i++) {
      if (document.UploadedFilesForm.elements[i].value.indexOf("viewer/extraLogo_right.") != -1) {
        document.write('&nbsp;<img src="/local/'+document.UploadedFilesForm.elements[i].value+'">');
        break;
      }
    }
  -->
  </script>
        </td>
            <td class="topTitle" align="center" id="view_prodName"><!--#echo var="glob_prodName" option="encoding:html" --></td>
<!--#endif -->
            <td align="right">
              <table cellpadding=0 cellspacing=5 border=0>
                <tr>
                  <td><a href="/" target="_top" class="linkActive" id="view_LViewTxt"></a></td><td>|</td>
<!--#if expr="$showSetup = yes" -->
                  <td><a href="" class="linkInActive" target="_top" id="view_SetTxt1"></a></td><td>|</td>
<!--#else -->
                  <td colspan="2"></td>
<!--#endif -->
                  <td><a href="#" onClick="javascript:launch('/help/liveview_h.shtml?cntrlQue=<!--#echo var="cntrlQue" option="encoding:url" -->'); return false;" class="linkInActive" id="view_HelpTxt"></a></td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </td>

      <td><img src="/pics/blank.gif" width="4" border=0 alt=""></td>
      <td class="lineBg"><img src="/pics/blank.gif" width=1 height=1 alt=""></td>
    </tr>
    <tr>
      <td class="lineBg"><img src="/pics/blank.gif" width=1 height=5 alt=""></td>
      <td colspan=3><img src="/pics/blank.gif" width=1 height=5 alt=""></td>
      <td class="lineBg"><img src="/pics/blank.gif" width=1 height=5 alt=""></td>
    </tr>
    <tr class="bottom-mainborder">
      <td colspan=2><img src="/pics/line_corner_lb_5x5px.gif" width=5 height=5 alt=""></td>
      <td background="/pics/line_b_100x5px.gif"><img src="/pics/blank.gif" width=768 height=5 alt=""></td>
      <td colspan=2><img src="/pics/line_corner_rb_5x5px.gif" width=5 height=5 alt=""></td>
    </tr>
    <tr>
      <td colspan=5><img src="/pics/blank.gif" width=1 height=5 border=0 alt=""></td>
    </tr>

    <tr>
      <td colspan=5>
        <table width="100%" cellpadding=0 cellspacing=0 border=0>
          <tbody>
          <tr id="appendableTr">
          </tr>
          </tbody>
        </table>
      </td>
    </tr>

    <tr>
      <td colspan=5><img src="/pics/blank.gif" width=1 height=5 border=0 alt=""></td>
    </tr>
    <tr class="top-mainborder">
      <td colspan=2><img src="/pics/line_corner_lt_5x5px.gif" width=5 height=5 border=0 alt=""></td>
      <td background="/pics/line_t_100x5px.gif"><img src="/pics/blank.gif" width=768 height=5 border=0 alt=""></td>
      <td colspan=2><img src="/pics/line_corner_rt_5x5px.gif" width=5 height=5 border=0 alt=""></td>
    </tr>

    <tr>
      <td width=1 class="lineBg"><img src="/pics/blank.gif" width=1 height=1 border=0 alt=""></td>
      <td width=4><img src="/pics/blank.gif" width=4 height=1 border=0 alt=""></td>
      <td valign="top" align="center" width="768">

      <!--#if expr="$root_Layout_Axis = no" -->
        <!--#if expr="$root_Layout_Title_Source != none" -->
          <table border=0 cellpadding=3 cellspacing=3>
            <tr>
              <td class="normalText" align="center"<!--#if expr="$showPTZBars != yes" --> colspan="2"<!--#endif -->>
                <b><!--#if expr="$root_Layout_Title_Source = default" --><span id="defTitTxt"></span><!--#else --><!--#echo var="root_Layout_Title_String" option="encoding:html" --><!--#endif --></b>
              </td>
              <!--#if expr="$showPTZBars = yes" --><!--#if expr="$external = no" -->
                <td width="60"><br></td>
              <!--#endif --><!--#endif -->
            </tr>
          </table>
        <!--#endif -->
      <!--#endif -->

      <table border="0" cellpadding="0" cellspacing="0" height="100%" width="776">
          <tr height=197>
            <td valign="top"></td>
            <td valign="top" class="normalText" align="center" rowspan=<!--#if expr="$showPTZBars = yes" -->4<!--#else -->2 colspan="2"<!--#endif -->>
              <div id="filterinstallocation"></div>
            </td>
            <td align="center" class="normalText">
              <table border="0" cellpadding="3" cellspacing="3">
                <tr>
                  <td>
                    <!--#if expr="$showPTZBars = yes" -->
                      <!--#if expr="$external = no" -->
                        <script src="/incl/pos.js?ver=<!--#echo var="root_Properties_Firmware_Version" option="encoding:url" -->"></script>
                        <!--#if expr="$showPTZCrosshair = yes" -->
                          <img id="crosshair" src="/pics/crosshair.png" width="16" height="16" style="position:absolute;visibility:hidden;left:0;top:0" border="0" />
                        <!--#endif -->
                      <!--#endif -->
                    <!--#endif -->

                    <script language="JavaScript">
                    <!--
                    <!--#set var="newimagepath" val="$imagepath$" -->
                    <!--#if expr="_$resolution != _" -->
                      <!--#if expr="$newimagepath >< ?" --><!--#set var="newimagepath" val="$newimagepath$&resolution=$resolution$" --><!--#else --><!--#set var="newimagepath" val="$newimagepath$?resolution=$resolution$" --><!--#endif -->
                    <!--#endif -->
                    <!--#if expr="_$streamprofile != _" -->
                        <!--#if expr="$invalidProfile != yes" -->
                          <!--#if expr="$newimagepath >< ?" -->
                            <!--#set var="newimagepath" val="$newimagepath$&streamprofile=$streamprofile$" -->
                          <!--#else -->
                            <!--#set var="newimagepath" val="$newimagepath$?streamprofile=$streamprofile$" -->
                          <!--#endif -->
                        <!--#endif -->
                      <!--#endif -->
                    <!--#if expr="_$imagepath != _" -->
                      var newimagepath = "<!--#echo var="newimagepath" option="encoding:url" -->";
                      var properties_audio_enabled = "<!--#echo var="root_Properties_Audio_Audio" option="encoding:javascript" -->";
                      var audiochannel_enabled = "<!--#echo var="root_Audio_A$audiochannel$_Enabled" option="encoding:javascript" -->";
                      var audiosource = "<!--#echo var="audionbr" option="encoding:javascript" -->";
                      var audiosupport = "<!--#echo var="root_AudioSource_A$audionbr$_AudioSupport" option="encoding:javascript" -->";
                      var videoformat = "<!--#echo var="fmt" option="encoding:javascript" -->";
                      var streamProfAudio = "<!--#echo var="audio" option="encoding:javascript" -->";
                      var streamProfUseAudio = (streamProfAudio == "no")?false:true;

                      if (newimagepath.indexOf('http://') !== -1 || newimagepath.indexOf('https://') !== -1 || newimagepath.indexOf('script') !== -1) {
	                      var cameraNbr;

	                      cameraNbr = 1

	                      <!--#if expr="$root_Layout_DefaultVideoFormat = mpeg4" -->
	                        <!--#set var="videocodec" val="mpeg4" -->
	                      <!--#elif expr="$root_Layout_DefaultVideoFormat = h264" -->
	                        <!--#set var="videocodec" val="h264" -->
	                      <!--#endif -->

                       <!--#if expr="_$videocodec!= _" -->
                         newimagepath = "/axis-media/media.amp?videocodec=" +"<!--#echo var="videocodec" option="encoding:javascript" -->" +"&camera=" + cameraNbr;
                       <!--#else -->
                         newimagepath = '/mjpg/' + cameraNbr + '/video.mjpg';
                       <!--#endif -->
                     }

                      if (properties_audio_enabled == "yes" && audiochannel_enabled == "yes" && audiosupport == "yes" && (videoformat == "h264+" || videoformat == "mpeg4+") && streamProfUseAudio)
                      {
                        newimagepath += "&audiochannel=" + (parseInt(audiosource, 10) + 1);
                      }
                      video(newimagepath);
                    <!--#endif -->
                    // -->
                    </script>
                  </td>
                  <!--#if expr="$showPTZBars = yes" -->
                    <!--#if expr="$external = no" -->
                      <td><div id="tbar" style=""><!--#include virtual="/incl/tiltbar.shtml" --></div></td>
                    <!--#endif -->
                  <!--#endif -->
                </tr>
              </table>

              <!--#if expr="$root_Layout_Axis = no" -->
                <!--#if expr="$root_Layout_Description_Source != none" -->
                  <table border="0" cellpadding="3" cellspacing="3">
                    <tr>
                      <td class="normalText" align="center"<!--#if expr="$showPTZBars != yes" --> colspan="2"<!--#endif -->>
                        <!--#if expr="$root_Layout_Description_Source = default" --><span id="defDescTxt"></span><!--#else --><!--#echo var="root_Layout_Description_String" option="encoding:html" --><!--#endif -->
                      </td>
                      <!--#if expr="$showPTZBars = yes" --><!--#if expr="$external = no" -->
                        <td width="60"><br></td>
                      <!--#endif --><!--#endif -->
                    </tr>
                  </table>
                <!--#endif -->
              <!--#endif -->
            </td>
          </tr>

          <!--#if expr="$showPTZBars = yes" -->
            <!--#if expr="$external = no" -->
              <tr id="pzbars" style="">
                <td colspan="4" width="100%">
                <table name="ptzcontrol_table" width="100%" border="0" cellpadding="0" cellspacing="0">
                  <tr>
                    <td width="50%" align="center">
                      <table width="100%" border="0" cellpadding="0" cellspacing="5">
                        <tr valign="top">
                          <td width="100%">
                            <img src="/pics/blank.gif" width="100%" height="100%">
                          </td>
                        </tr>
                      </table>
                    </td>
                    <td width="5">
                      <img src="/pics/blank.gif" width="5" height="100%">
                    </td>
                    <td valign="top">
                      <!--#include virtual="/incl/bars.shtml" -->
                    </td>
                    <td width="5">
                      <img src="/pics/blank.gif" width="5" height="100%">
                    </td>
            <!--#endif -->
          <!--#endif -->
          <!--#if expr="$showPTZBars = yes" -->
            <!--#if expr="$external = no" -->
                    <td width="50%" align="left">
                      <!--#set var="pcb_showall" val="no" -->
                      <!--#include virtual="/incl/ptzctrlpanel_incl.shtml" -->
                    </td>
                    <td width=1><img src="/pics/blank.gif" width=1 height=1 border=0 alt=""></td>
                    <td width=4><img src="/pics/blank.gif" width=4 height=1 border=0 alt=""></td>
                  </tr>
                </table>
            <!--#endif -->
          <!--#endif -->
            </td>
          </tr>
        </table>

        <!--#if expr="$showPTZBars = yes" -->
          <!--#if expr="$external = no" -->
            <!--#if expr="$cntrlQue = yes" -->
              <table border="0" cellpadding="3" cellspacing="0" width="100%">
                <tr>
                  <td class="subTitle" colspan="4" align="left"><span id="queUsTxt"></span></td>
                </tr>
                <tr>
                  <td nowrap class="oddItem" align="left"><span id="stIQTxt"></span></td>
                  <td nowrap class="oddItem" align="left"><input type="text" name="ptzqstatus" value="" size="65" disabled></td>
                  <td nowrap class="oddItem" align="left"><span id="poIQTxt"></span></td>
                  <td nowrap class="oddItem" align="left"><input type="text" name="ptzqpos" value="" size="10" disabled></td>
                </tr>
                <tr>
                  <td nowrap class="oddItem" align="left"><span id="tiReTxt"></span></td>
                  <td nowrap class="oddItem" align="left"><input type="text" name="ptzqtleft" value="" size="10" disabled>&nbsp;<span id="tiReSecTxt"></span></td>
                  <td nowrap colspan="2" class="oddItem" align="right">
                      <input type="hidden" name="ptzqcontrol" value="request">
                      <input type="hidden" name="ptzqcamera" value="<!--#echo var="camnbr" option="encoding:html" -->">
                      <input type="hidden" name="ptzqtagresponse" value="yes">
                      <input type="button" name="ptzqlabel" class="btnLarge" value="Request control" onClick="JavaScript:ctlReq()">
                      <input type="hidden" name="ptzqcontrol" value="query">
                      <input type="hidden" name="ptzqtagresponse" value="yes">
                      <input type="hidden" name="ptzqcamera" value="<!--#echo var="camnbr" option="encoding:html" -->">
                  </td>
                </tr>
              </table>
                <!--#if expr="$root_PTZ_BoaProtPTZOperator != " -->
                  <!--#include virtual="/sm/sm.srv?action=get&group=PTZ.BoaProtPTZOperator" -->
                <!--#endif -->
                <!--#if expr="$root_System_BoaProtViewer != " -->
                  <!--#include virtual="/sm/sm.srv?action=get&group=System.BoaProtViewer" -->
                <!--#endif -->
                <!--#if expr="$root_PTZ_BoaProtPTZOperator$_$root_System_BoaProtViewer$ != password_anonymous" -->
                  <script language="JavaScript">ctlStart();</script>
                <!--#endif -->
            <!--#endif -->
            <!--#include virtual="/incl/ptz_incl.shtml" -->
          <!--#endif -->
        <!--#endif -->
      </td>
      <td width=4><img src="/pics/blank.gif" width=4 height=1 border=0 alt=""></td>
      <td width=1 class="lineBg"><img src="/pics/blank.gif" width=1 height=1 border=0 alt=""></td>
    </tr>
    <!-- ################################################################ -->
    <!-- Defines the table width -->
    <tr>
      <td colspan=1 width=1 class="lineBg"><img src="/pics/blank.gif" width=1 height=1 alt=""></td>
      <td colspan=1 width=4><img src="/pics/blank.gif" width=1 height=1 alt=""></td>
      <td colspan=1 width=768><img src="/pics/blank.gif" width=1 height=1 alt=""></td>
      <td colspan=1 width=4><img src="/pics/blank.gif" width=1 height=1 alt=""></td>
      <td colspan=1 width=1 class="lineBg"><img src="/pics/blank.gif" width=1 height=1 alt=""></td>
    </tr>
    <!-- ################################################################ -->
    <tr class="bottom-mainborder">
      <td colspan=2><img src="/pics/line_corner_lb_5x5px.gif" width=5 height=5 alt=""></td>
      <td colspan=1 background="/pics/line_b_100x5px.gif"><img src="/pics/blank.gif" width=1 height=1 alt=""></td>
      <td colspan=2><img src="/pics/line_corner_rb_5x5px.gif" width=5 height=5 alt=""></td>
    </tr>


    <tr>
      <td width=1><img src="/pics/blank.gif" width="1" height="1" border="0" alt=""></td>
      <td colspan=6 valign="middle" align="left">
        <table cellpadding=0 cellspacing=5 border="0">
          <tr>
          <!--#if expr="$root_Layout_CustomLink_C0_Enabled = yes" -->
            <td>
              <a href="<!--#echo var="root_Layout_CustomLink_C0_URL" option="encoding:url" -->" class="linkInActive" target="<!--#if expr="$root_Layout_CustomLink_C0_Usage = cgi" -->Temp<!--#else -->_blank<!--#endif -->"><!--#echo var="root_Layout_CustomLink_C0_Name" option="encoding:html" --></A>
            </td>
          <!--#endif -->
          <!--#if expr="$root_Layout_CustomLink_C1_Enabled = yes" -->
            <!--#if expr="$root_Layout_CustomLink_C0_Enabled = yes" -->
              <td>|</td>
            <!--#endif -->
            <td>
              <a href="<!--#echo var="root_Layout_CustomLink_C1_URL" option="encoding:url" -->" class="linkInActive" target="<!--#if expr="$root_Layout_CustomLink_C1_Usage = cgi" -->Temp<!--#else -->_blank<!--#endif -->"><!--#echo var="root_Layout_CustomLink_C1_Name" option="encoding:html" --></A>
            </td>
          <!--#endif -->
          <!--#if expr="$root_Layout_CustomLink_C2_Enabled = yes" -->
            <!--#if expr="$root_Layout_CustomLink_C0_Enabled = yes" -->
              <td>|</td>
            <!--#elif expr="$root_Layout_CustomLink_C1_Enabled = yes" -->
              <td>|</td>
            <!--#endif -->
            <td>
              <a href="<!--#echo var="root_Layout_CustomLink_C2_URL" option="encoding:url" -->" class="linkInActive" target="<!--#if expr="$root_Layout_CustomLink_C2_Usage = cgi" -->Temp<!--#else -->_blank<!--#endif -->"><!--#echo var="root_Layout_CustomLink_C2_Name" option="encoding:html" --></A>
            </td>
          <!--#endif -->
          <!--#if expr="$root_Layout_CustomLink_C3_Enabled = yes" -->
            <!--#if expr="$root_Layout_CustomLink_C0_Enabled = yes" -->
              <td>|</td>
            <!--#elif expr="$root_Layout_CustomLink_C1_Enabled = yes" -->
              <td>|</td>
            <!--#elif expr="$root_Layout_CustomLink_C2_Enabled = yes" -->
              <td>|</td>
            <!--#endif -->
            <td>
              <a href="<!--#echo var="root_Layout_CustomLink_C3_URL" option="encoding:url" -->" class="linkInActive" target="<!--#if expr="$root_Layout_CustomLink_C3_Usage = cgi" -->Temp<!--#else -->_blank<!--#endif -->"><!--#echo var="root_Layout_CustomLink_C3_Name" option="encoding:html" --></A>
            </td>
          <!--#else -->
            <td>&nbsp;</td>
          <!--#endif -->
          </tr>
        </table>
      </td>
      <td width=1><img src="/pics/blank.gif" width="1" height="1" border="0" alt=""></td>
    </tr>
  </table>
</td></tr>
</form> <!-- wizardForm -->
</table>
</body>
</html>
