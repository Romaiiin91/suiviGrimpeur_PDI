<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Interface avec liste déroulante</title>
    <script src="jquery.js"></script>
</head>
<body>
    

    <!-- Boutons -->
    <h2>Déplacement</h2>
    <input type="button" value="Up" onclick="up();"/> 
    <input type="button" value="Down" onclick="down();"/> 
    <input type="button" value="Left" onclick="left();"/> 
    <input type="button" value="Right" onclick="right();"/> 
	<!-- Faire les zoom -->


	<h2>Enregistrement</h2>
    <input type="button" value="Commencer l'enregistrement" onclick="startRecord();"/> 
    <input type="button" value="Stop l'enregistrement" onclick="stopRecord();"/> 

	<h2>Détection</h2>
    <input type="button" value="Commencer la détection" onclick="startDetection();"/> 
    <input type="button" value="Stop la détection" onclick="stopDetection();"/> 

	<!-- Positions -->
	<h2>Voies</h2>
	<select id="dropdown"></select>
	<input type="button" value="Sauvegarder la position de caméra" onclick="addRoute();"/> 
    <input type="button" value="Supprimer la voie sélectionnée" onclick="removeRoute();"/> 
	<input type="button" value="Afficher la voie sélectionnée cette voie" onclick="showRoute();"/>

    <script>
        function envoi() {
            console.log("click sur envoyer");
            $.get("action.cgi", {data: "toto", dir: "N"});
        }
        function up() { console.log("move up"); $.get("action.cgi", {move: "up"}); }
        function down() { console.log("move down"); $.get("action.cgi", {move: "down"}); }
        function left() { console.log("move left"); $.get("action.cgi", {move: "left"}); }
        function right() { console.log("move right"); $.get("action.cgi", {move: "right"}); }
        function startRecord() { console.log("record on"); $.get("action.cgi", {reco: "on"}); }
        function stopRecord() { console.log("record off"); $.get("action.cgi", {reco: "off"}); }
        function startDetection() { console.log("detection on"); $.get("action.cgi", {detc: "on"}); }
        function stopDetection() { console.log("detection off"); $.get("action.cgi", {detc: "off"}); }

        // Charger et afficher les options
        function loadOptions() {
            
            // Clear existing options
            const dropdown = document.getElementById("dropdown");
            dropdown.innerHTML = ''; // Reset the dropdown content

            // Fetch JSON data
            $.getJSON("positionsEnregistrees.json", function (data) {
                for (let key in data) {
                    const option = document.createElement("option");
                    option.value = key;
                    option.textContent = `Voie ${key}`;
                    dropdown.appendChild(option);
                }
            }).fail(function () {
                console.error("Erreur de chargement des options.");
            });
        }
		function addRoute() {
            // Demander un numéro à l'utilisateur
			const number = prompt("Entrez un numéro de voie :");

			// Vérifier si l'utilisateur a entré quelque chose
			if (number !== null && number.trim() !== "") {
				console.log("Numéro saisi :", number);
				$.get("action.cgi", { rout: "add", id: number});

			} else alert("Action annulée ou numéro invalide.");

        }
		function removeRoute() {
            const dropdown = document.getElementById("dropdown");
            const selectedKey = dropdown.value;
            console.log(`Voie selectionnee : ${selectedKey}`);
            $.get("action.cgi", {rout: "rem", id: selectedKey });

            // acknowledgment 
        }
        function showRoute() {
            const dropdown = document.getElementById("dropdown");
            const selectedKey = dropdown.value;
            console.log(`Voie selectionnee : ${selectedKey}`);
            $.get("action.cgi", {rout:"shw", id: selectedKey});
        }

        // Charger les options au démarrage
        document.addEventListener("DOMContentLoaded", loadOptions);
    </script>
</body>
</html>
